import{f as Tn,e as Bt,N as tt,g as Sn,P as I,h as _,S as K,R as En,E as An,i as Ln,T as P,k as $n,D as In,l as we,F as j,m as Pn,n as xt,o as _n,p as Nn,q as Rn,s as Bn,v as On,w as Hn,x as Dn,y as jn,z as Me,A as zn,B as Fn,C as Vn,G as Wn,H as Un,I as Kn,J as qn,K as Gn,M as Jn,O as Xn,Q as Yn,U as Zn,V as Qt,W as Qn,X as lt,Y as tr,Z as er,_ as nr,$ as rr,a0 as sr,r as N,j as B,a1 as q,a2 as xe,a3 as or,a4 as ir,a5 as ar,a6 as lr,a7 as ut,a8 as Ot,a9 as cr,aa as ur,ab as dr,ac as pr,ad as te,ae as hr,af as Ce,ag as fr,ah as mr,ai as gr,aj as Te,ak as br,al as ee,am as yr,an as ne,ao as re,ap as vr,aq as se,ar as kr,as as wr,at as Mr,au as xr,av as Cr,aw as Tr,ax as Sr}from"./vendor-core-CFA-k7Cr.js";var Er=Object.defineProperty,Ht=(t,e)=>{for(var n in e)Er(t,n,{get:e[n],enumerable:!0})};function ft(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:s}=n,{storedMarks:o}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,o=n.storedMarks,n}}}var mt=class{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:e,state:n}=this,{view:r}=e,{tr:s}=n,o=this.buildProps(s);return Object.fromEntries(Object.entries(t).map(([i,a])=>[i,(...c)=>{const u=a(...c)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(s),u}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:o}=r,i=[],a=!!t,l=t||s.tr,c=()=>(!a&&e&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(l),i.every(d=>d===!0)),u={...Object.fromEntries(Object.entries(n).map(([d,p])=>[d,(...f)=>{const m=this.buildProps(l,e),g=p(...f)(m);return i.push(g),u}])),run:c};return u}createCan(t){const{rawCommands:e,state:n}=this,r=!1,s=t||n.tr,o=this.buildProps(s,r);return{...Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...c)=>l(...c)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,r)}}buildProps(t,e=!0){const{rawCommands:n,editor:r,state:s}=this,{view:o}=r,i={tr:t,editor:r,view:o,state:ft({state:s,transaction:t}),dispatch:e?()=>{}:void 0,chain:()=>this.createChain(t,e),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(n).map(([a,l])=>[a,(...c)=>l(...c)(i)]))}};return i}},Se={};Ht(Se,{blur:()=>Ar,clearContent:()=>Lr,clearNodes:()=>$r,command:()=>Ir,createParagraphNear:()=>Pr,cut:()=>_r,deleteCurrentNode:()=>Nr,deleteNode:()=>Rr,deleteRange:()=>Br,deleteSelection:()=>Or,enter:()=>Hr,exitCode:()=>Dr,extendMarkRange:()=>jr,first:()=>zr,focus:()=>Vr,forEach:()=>Wr,insertContent:()=>Ur,insertContentAt:()=>Gr,joinBackward:()=>Yr,joinDown:()=>Xr,joinForward:()=>Zr,joinItemBackward:()=>Qr,joinItemForward:()=>ts,joinTextblockBackward:()=>es,joinTextblockForward:()=>ns,joinUp:()=>Jr,keyboardShortcut:()=>ss,lift:()=>os,liftEmptyBlock:()=>is,liftListItem:()=>as,newlineInCode:()=>ls,resetAttributes:()=>cs,scrollIntoView:()=>us,selectAll:()=>ds,selectNodeBackward:()=>ps,selectNodeForward:()=>hs,selectParentNode:()=>fs,selectTextblockEnd:()=>ms,selectTextblockStart:()=>gs,setContent:()=>bs,setMark:()=>Ns,setMeta:()=>Rs,setNode:()=>Bs,setNodeSelection:()=>Os,setTextSelection:()=>Hs,sinkListItem:()=>Ds,splitBlock:()=>js,splitListItem:()=>zs,toggleList:()=>Fs,toggleMark:()=>Vs,toggleNode:()=>Ws,toggleWrap:()=>Us,undoInputRule:()=>Ks,unsetAllMarks:()=>qs,unsetMark:()=>Gs,updateAttributes:()=>Js,wrapIn:()=>Xs,wrapInList:()=>Ys});var Ar=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window?.getSelection())==null||n.removeAllRanges())}),!0),Lr=(t=!0)=>({commands:e})=>e.setContent("",{emitUpdate:t}),$r=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:s}=r;return n&&s.forEach(({$from:o,$to:i})=>{t.doc.nodesBetween(o.pos,i.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),p=c.resolve(u.map(l+a.nodeSize)),h=d.blockRange(p);if(!h)return;const f=_n(h);if(a.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(h.start,m)}(f||f===0)&&e.lift(h,f)})}),!0},Ir=t=>e=>t(e),Pr=()=>({state:t,dispatch:e})=>Nn(t,e),_r=(t,e)=>({editor:n,tr:r})=>{const{state:s}=n,o=s.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const i=r.mapping.map(e);return r.insert(i,o.content),r.setSelection(new P(r.doc.resolve(Math.max(i-1,0)))),!0},Nr=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const s=t.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===r.type){if(e){const a=s.before(o),l=s.after(o);t.delete(a,l).scrollIntoView()}return!0}return!1};function A(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}var Rr=t=>({tr:e,state:n,dispatch:r})=>{const s=A(t,n.schema),o=e.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===s){if(r){const l=o.before(i),c=o.after(i);e.delete(l,c).scrollIntoView()}return!0}return!1},Br=t=>({tr:e,dispatch:n})=>{const{from:r,to:s}=t;return n&&e.delete(r,s),!0},Or=()=>({state:t,dispatch:e})=>Rn(t,e),Hr=()=>({commands:t})=>t.keyboardShortcut("Enter"),Dr=()=>({state:t,dispatch:e})=>Bn(t,e);function Dt(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function dt(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>n.strict?e[s]===t[s]:Dt(e[s])?e[s].test(t[s]):e[s]===t[s]):!0}function Ee(t,e,n={}){return t.find(r=>r.type===e&&dt(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function oe(t,e,n={}){return!!Ee(t,e,n)}function jt(t,e,n){var r;if(!t||!e)return;let s=t.parent.childAfter(t.parentOffset);if((!s.node||!s.node.marks.some(u=>u.type===e))&&(s=t.parent.childBefore(t.parentOffset)),!s.node||!s.node.marks.some(u=>u.type===e)||(n=n||((r=s.node.marks[0])==null?void 0:r.attrs),!Ee([...s.node.marks],e,n)))return;let i=s.index,a=t.start()+s.offset,l=i+1,c=a+s.node.nodeSize;for(;i>0&&oe([...t.parent.child(i-1).marks],e,n);)i-=1,a-=t.parent.child(i).nodeSize;for(;l<t.parent.childCount&&oe([...t.parent.child(l).marks],e,n);)c+=t.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function H(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}var jr=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const o=H(t,r.schema),{doc:i,selection:a}=n,{$from:l,from:c,to:u}=a;if(s){const d=jt(l,o,e);if(d&&d.from<=c&&d.to>=u){const p=P.create(i,d.from,d.to);n.setSelection(p)}}return!0},zr=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function Ae(t){return t instanceof P}function U(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function Le(t,e=null){if(!e)return null;const n=K.atStart(t),r=K.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const s=n.from,o=r.to;return e==="all"?P.create(t,U(0,s,o),U(t.content.size,s,o)):P.create(t,U(e,s,o),U(e,s,o))}function Fr(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function zt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var Vr=(t=null,e={})=>({editor:n,view:r,tr:s,dispatch:o})=>{e={scrollIntoView:!0,...e};const i=()=>{(zt()||Fr())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(o&&t===null&&!Ae(n.state.selection))return i(),!0;const a=Le(s.doc,t)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},Wr=(t,e)=>n=>t.every((r,s)=>e(r,{...n,index:s})),Ur=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),$e=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&$e(r)}return t};function rt(t){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return $e(n)}function Z(t,e,n){if(t instanceof Pn||t instanceof j)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,s=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return j.fromArray(t.map(a=>e.nodeFromJSON(a)));const i=e.nodeFromJSON(t);return n.errorOnInvalidContent&&i.check(),i}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",o),Z("",e,n)}if(s){if(n.errorOnInvalidContent){let i=!1,a="";const l=new we({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(i=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?xt.fromSchema(l).parseSlice(rt(t),n.parseOptions):xt.fromSchema(l).parse(rt(t),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=xt.fromSchema(e);return n.slice?o.parseSlice(rt(t),n.parseOptions).content:o.parse(rt(t),n.parseOptions)}return Z("",e,n)}function Kr(t,e,n){const r=t.steps.length-1;if(r<e)return;const s=t.steps[r];if(!(s instanceof rr||s instanceof sr))return;const o=t.mapping.maps[r];let i=0;o.forEach((a,l,c,u)=>{i===0&&(i=u)}),t.setSelection(K.near(t.doc.resolve(i),n))}var qr=t=>!("type"in t),Gr=(t,e,n)=>({tr:r,dispatch:s,editor:o})=>{var i;if(s){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;const l=g=>{o.emit("contentError",{editor:o,error:g,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{Z(e,o.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(g){l(g)}try{a=Z(e,o.schema,{parseOptions:c,errorOnInvalidContent:(i=n.errorOnInvalidContent)!=null?i:o.options.enableContentCheck})}catch(g){return l(g),!1}let{from:u,to:d}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},p=!0,h=!0;if((qr(a)?a:[a]).forEach(g=>{g.check(),p=p?g.isText&&g.marks.length===0:!1,h=h?g.isBlock:!1}),u===d&&h){const{parent:g}=r.doc.resolve(u);g.isTextblock&&!g.type.spec.code&&!g.childCount&&(u-=1,d+=1)}let m;if(p){if(Array.isArray(e))m=e.map(g=>g.text||"").join("");else if(e instanceof j){let g="";e.forEach(b=>{b.text&&(g+=b.text)}),m=g}else typeof e=="object"&&e&&e.text?m=e.text:m=e;r.insertText(m,u,d)}else{m=a;const g=r.doc.resolve(u),b=g.node(),y=g.parentOffset===0,k=b.isText||b.isTextblock,M=b.content.size>0;y&&k&&M&&(u=Math.max(0,u-1)),r.replaceWith(u,d,m)}n.updateSelection&&Kr(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:m}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:m})}return!0},Jr=()=>({state:t,dispatch:e})=>On(t,e),Xr=()=>({state:t,dispatch:e})=>Hn(t,e),Yr=()=>({state:t,dispatch:e})=>Dn(t,e),Zr=()=>({state:t,dispatch:e})=>jn(t,e),Qr=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Me(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},ts=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Me(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},es=()=>({state:t,dispatch:e})=>zn(t,e),ns=()=>({state:t,dispatch:e})=>Fn(t,e);function Ie(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function rs(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,s,o,i;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))zt()||Ie()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}var ss=t=>({editor:e,view:n,tr:r,dispatch:s})=>{const o=rs(t).split(/-(?!$)/),i=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l?.steps.forEach(c=>{const u=c.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function z(t,e,n={}){const{from:r,to:s,empty:o}=t.selection,i=e?A(e,t.schema):null,a=[];t.doc.nodesBetween(r,s,(d,p)=>{if(d.isText)return;const h=Math.max(r,p),f=Math.min(s,p+d.nodeSize);a.push({node:d,from:h,to:f})});const l=s-r,c=a.filter(d=>i?i.name===d.node.type.name:!0).filter(d=>dt(d.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((d,p)=>d+p.to-p.from,0)>=l}var os=(t,e={})=>({state:n,dispatch:r})=>{const s=A(t,n.schema);return z(n,s,e)?Vn(n,r):!1},is=()=>({state:t,dispatch:e})=>Wn(t,e),as=t=>({state:e,dispatch:n})=>{const r=A(t,e.schema);return Un(r)(e,n)},ls=()=>({state:t,dispatch:e})=>Kn(t,e);function gt(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function ie(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,s)=>(n.includes(s)||(r[s]=t[s]),r),{})}var cs=(t,e)=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=gt(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=A(t,r.schema)),a==="mark"&&(i=H(t,r.schema)),s&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{o&&o===c.type&&n.setNodeMarkup(u,void 0,ie(c.attrs,e)),i&&c.marks.length&&c.marks.forEach(d=>{i===d.type&&n.addMark(u,u+c.nodeSize,i.create(ie(d.attrs,e)))})})}),!0):!1},us=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),ds=()=>({tr:t,dispatch:e})=>{if(e){const n=new qn(t.doc);t.setSelection(n)}return!0},ps=()=>({state:t,dispatch:e})=>Gn(t,e),hs=()=>({state:t,dispatch:e})=>Jn(t,e),fs=()=>({state:t,dispatch:e})=>Xn(t,e),ms=()=>({state:t,dispatch:e})=>Yn(t,e),gs=()=>({state:t,dispatch:e})=>Zn(t,e);function At(t,e,n={},r={}){return Z(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var bs=(t,{errorOnInvalidContent:e,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:s,tr:o,dispatch:i,commands:a})=>{const{doc:l}=o;if(r.preserveWhitespace!=="full"){const c=At(t,s.schema,r,{errorOnInvalidContent:e??s.options.enableContentCheck});return i&&o.replaceWith(0,l.content.size,c).setMeta("preventUpdate",!n),!0}return i&&o.setMeta("preventUpdate",!n),a.insertContentAt({from:0,to:l.content.size},t,{parseOptions:r,errorOnInvalidContent:e??s.options.enableContentCheck})};function Pe(t,e){const n=H(e,t.schema),{from:r,to:s,empty:o}=t.selection,i=[];o?(t.storedMarks&&i.push(...t.storedMarks),i.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,s,l=>{i.push(...l.marks)});const a=i.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function _e(t,e){const n=new Sn(t);return e.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function ys(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function vs(t,e,n){const r=[];return t.nodesBetween(e.from,e.to,(s,o)=>{n(s)&&r.push({node:s,pos:o})}),r}function Ne(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function bt(t){return e=>Ne(e.$from,t)}function v(t,e,n){return t.config[e]===void 0&&t.parent?v(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?v(t.parent,e,n):null}):t.config[e]}function Ft(t){return t.map(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=v(e,"addExtensions",n);return r?[e,...Ft(r())]:e}).flat(10)}function Vt(t,e){const n=In.fromSchema(e).serializeFragment(t),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function Re(t){return typeof t=="function"}function T(t,e=void 0,...n){return Re(t)?e?t.bind(e)(...n):t(...n):t}function ks(t={}){return Object.keys(t).length===0&&t.constructor===Object}function Q(t){const e=t.filter(s=>s.type==="extension"),n=t.filter(s=>s.type==="node"),r=t.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function Be(t){const e=[],{nodeExtensions:n,markExtensions:r}=Q(t),s=[...n,...r],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage,extensions:s},l=v(i,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([p,h])=>{e.push({type:d,name:p,attribute:{...o,...h}})})})})}),s.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},l=v(i,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const p={...o,...d};typeof p?.default=="function"&&(p.default=p.default()),p?.isRequired&&p?.default===void 0&&delete p.default,e.push({type:i.name,name:u,attribute:p})})}),e}function E(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([s,o])=>{if(!r[s]){r[s]=o;return}if(s==="class"){const a=o?String(o).split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(u=>!l.includes(u));r[s]=[...l,...c].join(" ")}else if(s==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[s]?r[s].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,p]=u.split(":").map(h=>h.trim());c.set(d,p)}),a.forEach(u=>{const[d,p]=u.split(":").map(h=>h.trim());c.set(d,p)}),r[s]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[s]=o}),r},{})}function pt(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>E(n,r),{})}function ws(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function ae(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const s=e.reduce((o,i)=>{const a=i.attribute.parseHTML?i.attribute.parseHTML(n):ws(n.getAttribute(i.name));return a==null?o:{...o,[i.name]:a}},{});return{...r,...s}}}}function le(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&ks(n)?!1:n!=null))}function Ms(t,e){var n;const r=Be(t),{nodeExtensions:s,markExtensions:o}=Q(t),i=(n=s.find(c=>v(c,"topNode")))==null?void 0:n.name,a=Object.fromEntries(s.map(c=>{const u=r.filter(b=>b.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},p=t.reduce((b,y)=>{const k=v(y,"extendNodeSchema",d);return{...b,...k?k(c):{}}},{}),h=le({...p,content:T(v(c,"content",d)),marks:T(v(c,"marks",d)),group:T(v(c,"group",d)),inline:T(v(c,"inline",d)),atom:T(v(c,"atom",d)),selectable:T(v(c,"selectable",d)),draggable:T(v(c,"draggable",d)),code:T(v(c,"code",d)),whitespace:T(v(c,"whitespace",d)),linebreakReplacement:T(v(c,"linebreakReplacement",d)),defining:T(v(c,"defining",d)),isolating:T(v(c,"isolating",d)),attrs:Object.fromEntries(u.map(b=>{var y,k;return[b.name,{default:(y=b?.attribute)==null?void 0:y.default,validate:(k=b?.attribute)==null?void 0:k.validate}]}))}),f=T(v(c,"parseHTML",d));f&&(h.parseDOM=f.map(b=>ae(b,u)));const m=v(c,"renderHTML",d);m&&(h.toDOM=b=>m({node:b,HTMLAttributes:pt(b,u)}));const g=v(c,"renderText",d);return g&&(h.toText=g),[c.name,h]})),l=Object.fromEntries(o.map(c=>{const u=r.filter(g=>g.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},p=t.reduce((g,b)=>{const y=v(b,"extendMarkSchema",d);return{...g,...y?y(c):{}}},{}),h=le({...p,inclusive:T(v(c,"inclusive",d)),excludes:T(v(c,"excludes",d)),group:T(v(c,"group",d)),spanning:T(v(c,"spanning",d)),code:T(v(c,"code",d)),attrs:Object.fromEntries(u.map(g=>{var b,y;return[g.name,{default:(b=g?.attribute)==null?void 0:b.default,validate:(y=g?.attribute)==null?void 0:y.validate}]}))}),f=T(v(c,"parseHTML",d));f&&(h.parseDOM=f.map(g=>ae(g,u)));const m=v(c,"renderHTML",d);return m&&(h.toDOM=g=>m({mark:g,HTMLAttributes:pt(g,u)})),[c.name,h]}));return new we({topNode:i,nodes:a,marks:l})}function xs(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}function Wt(t){return t.sort((n,r)=>{const s=v(n,"priority")||100,o=v(r,"priority")||100;return s>o?-1:s<o?1:0})}function Oe(t){const e=Wt(Ft(t)),n=xs(e.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),e}function He(t,e,n){const{from:r,to:s}=e,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let a="";return t.nodesBetween(r,s,(l,c,u,d)=>{var p;l.isBlock&&c>r&&(a+=o);const h=i?.[l.type.name];if(h)return u&&(a+=h({node:l,pos:c,parent:u,index:d,range:e})),!1;l.isText&&(a+=(p=l?.text)==null?void 0:p.slice(Math.max(r,c)-c,s-c))}),a}function Cs(t,e){const n={from:0,to:t.content.size};return He(t,n,e)}function De(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}function Ts(t,e){const n=A(e,t.schema),{from:r,to:s}=t.selection,o=[];t.doc.nodesBetween(r,s,a=>{o.push(a)});const i=o.reverse().find(a=>a.type.name===n.name);return i?{...i.attrs}:{}}function je(t,e){const n=gt(typeof e=="string"?e:e.name,t.schema);return n==="node"?Ts(t,e):n==="mark"?Pe(t,e):{}}function Ss(t,e=JSON.stringify){const n={};return t.filter(r=>{const s=e(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function Es(t){const e=Ss(t);return e.length===1?e:e.filter((n,r)=>!e.filter((o,i)=>i!==r).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function ze(t){const{mapping:e,steps:n}=t,r=[];return e.maps.forEach((s,o)=>{const i=[];if(s.ranges.length)s.forEach((a,l)=>{i.push({from:a,to:l})});else{const{from:a,to:l}=n[o];if(a===void 0||l===void 0)return;i.push({from:a,to:l})}i.forEach(({from:a,to:l})=>{const c=e.slice(o).map(a,-1),u=e.slice(o).map(l),d=e.invert().map(c,-1),p=e.invert().map(u);r.push({oldRange:{from:d,to:p},newRange:{from:c,to:u}})})}),Es(r)}function Ut(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(s=>{const o=n.resolve(t),i=jt(o,s.type);i&&r.push({mark:s,...i})}):n.nodesBetween(t,e,(s,o)=>{!s||s?.nodeSize===void 0||r.push(...s.marks.map(i=>({from:o,to:o+s.nodeSize,mark:i})))}),r}var As=(t,e,n,r=20)=>{const s=t.doc.resolve(n);let o=r,i=null;for(;o>0&&i===null;){const a=s.node(o);a?.type.name===e?i=a:o-=1}return[i,o]};function Ct(t,e){return e.nodes[t]||e.marks[t]||null}function ct(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=t.find(o=>o.type===e&&o.name===r);return s?s.attribute.keepOnSplit:!1}))}var Ls=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(s,o,i,a)=>{var l,c;const u=((c=(l=s.type.spec).toText)==null?void 0:c.call(l,{node:s,pos:o,parent:i,index:a}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-o))}),n};function Lt(t,e,n={}){const{empty:r,ranges:s}=t.selection,o=e?H(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>dt(d.attrs,n,{strict:!1}));let i=0;const a=[];if(s.forEach(({$from:d,$to:p})=>{const h=d.pos,f=p.pos;t.doc.nodesBetween(h,f,(m,g)=>{if(!m.isText&&!m.marks.length)return;const b=Math.max(h,g),y=Math.min(f,g+m.nodeSize),k=y-b;i+=k,a.push(...m.marks.map(M=>({mark:M,from:b,to:y})))})}),i===0)return!1;const l=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>dt(d.mark.attrs,n,{strict:!1})).reduce((d,p)=>d+p.to-p.from,0),c=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,p)=>d+p.to-p.from,0);return(l>0?l+c:l)>=i}function $s(t,e,n={}){if(!e)return z(t,null,n)||Lt(t,null,n);const r=gt(e,t.schema);return r==="node"?z(t,e,n):r==="mark"?Lt(t,e,n):!1}var Is=(t,e)=>{const{$from:n,$to:r,$anchor:s}=t.selection;if(e){const o=bt(a=>a.type.name===e)(t.selection);if(!o)return!1;const i=t.doc.resolve(o.pos+1);return s.pos+1===i.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},Ps=t=>{const{$from:e,$to:n}=t.selection;return!(e.parentOffset>0||e.pos!==n.pos)};function ce(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function ue(t,e){const{nodeExtensions:n}=Q(e),r=n.find(i=>i.name===t);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},o=T(v(r,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}function yt(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!=null?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let s=!0;return t.content.forEach(o=>{s!==!1&&(yt(o,{ignoreWhitespace:n,checkChildren:e})||(s=!1))}),s}return!1}function Fe(t){return t instanceof tt}function _s(t,e,n){var r;const{selection:s}=e;let o=null;if(Ae(s)&&(o=s.$cursor),o){const a=(r=t.storedMarks)!=null?r:o.marks();return o.parent.type.allowsMarkType(n)&&(!!n.isInSet(a)||!a.some(c=>c.type.excludes(n)))}const{ranges:i}=s;return i.some(({$from:a,$to:l})=>{let c=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,l.pos,(u,d,p)=>{if(c)return!1;if(u.isInline){const h=!p||p.type.allowsMarkType(n),f=!!n.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(n));c=h&&f}return!c}),c})}var Ns=(t,e={})=>({tr:n,state:r,dispatch:s})=>{const{selection:o}=n,{empty:i,ranges:a}=o,l=H(t,r.schema);if(s)if(i){const c=Pe(r,l);n.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(p,h)=>{const f=Math.max(h,u),m=Math.min(h+p.nodeSize,d);p.marks.find(b=>b.type===l)?p.marks.forEach(b=>{l===b.type&&n.addMark(f,m,l.create({...b.attrs,...e}))}):n.addMark(f,m,l.create(e))})});return _s(r,n,l)},Rs=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),Bs=(t,e={})=>({state:n,dispatch:r,chain:s})=>{const o=A(t,n.schema);let i;return n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),o.isTextblock?s().command(({commands:a})=>Qt(o,{...i,...e})(n)?!0:a.clearNodes()).command(({state:a})=>Qt(o,{...i,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Os=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,s=U(t,0,r.content.size),o=tt.create(r,s);e.setSelection(o)}return!0},Hs=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:s,to:o}=typeof t=="number"?{from:t,to:t}:t,i=P.atStart(r).from,a=P.atEnd(r).to,l=U(s,i,a),c=U(o,i,a),u=P.create(r,l,c);e.setSelection(u)}return!0},Ds=t=>({state:e,dispatch:n})=>{const r=A(t,e.schema);return Qn(r)(e,n)};function de(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(s=>e?.includes(s.type.name));t.tr.ensureMarks(r)}}var js=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:s})=>{const{selection:o,doc:i}=e,{$from:a,$to:l}=o,c=s.extensionManager.attributes,u=ct(c,a.node().type.name,a.node().attrs);if(o instanceof tt&&o.node.isBlock)return!a.parentOffset||!lt(i,a.pos)?!1:(r&&(t&&de(n,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,p=a.depth===0?void 0:ys(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=d&&p?[{type:p,attrs:u}]:void 0,f=lt(e.doc,e.mapping.map(a.pos),1,h);if(!h&&!f&&lt(e.doc,e.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(f=!0,h=p?[{type:p,attrs:u}]:void 0),r){if(f&&(o instanceof P&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,h),p&&!d&&!a.parentOffset&&a.parent.type!==p)){const m=e.mapping.map(a.before()),g=e.doc.resolve(m);a.node(-1).canReplaceWith(g.index(),g.index()+1,p)&&e.setNodeMarkup(e.mapping.map(a.before()),p)}t&&de(n,s.extensionManager.splittableMarks),e.scrollIntoView()}return f},zs=(t,e={})=>({tr:n,state:r,dispatch:s,editor:o})=>{var i;const a=A(t,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const p=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let b=j.empty;const y=l.index(-1)?1:l.index(-2)?2:3;for(let $=l.depth-y;$>=l.depth-3;$-=1)b=j.from(l.node($).copy(b));const k=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,M={...ct(p,l.node().type.name,l.node().attrs),...e},w=((i=a.contentMatch.defaultType)==null?void 0:i.createAndFill(M))||void 0;b=b.append(j.from(a.createAndFill(null,w)||void 0));const C=l.before(l.depth-(y-1));n.replace(C,l.after(-k),new tr(b,4-y,0));let x=-1;n.doc.nodesBetween(C,n.doc.content.size,($,R)=>{if(x>-1)return!1;$.isTextblock&&$.content.size===0&&(x=R+1)}),x>-1&&n.setSelection(P.near(n.doc.resolve(x))),n.scrollIntoView()}return!0}const h=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,f={...ct(p,d.type.name,d.attrs),...e},m={...ct(p,l.node().type.name,l.node().attrs),...e};n.delete(l.pos,c.pos);const g=h?[{type:a,attrs:f},{type:h,attrs:m}]:[{type:a,attrs:f}];if(!lt(n.doc,l.pos,2))return!1;if(s){const{selection:b,storedMarks:y}=r,{splittableMarks:k}=o.extensionManager,M=y||b.$to.parentOffset&&b.$from.marks();if(n.split(l.pos,2,g).scrollIntoView(),!M||!s)return!0;const w=M.filter(C=>k.includes(C.type.name));n.ensureMarks(w)}return!0},Tt=(t,e)=>{const n=bt(i=>i.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===s?.type&&Bt(t.doc,n.pos)&&t.join(n.pos),!0},St=(t,e)=>{const n=bt(i=>i.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=t.doc.nodeAt(r);return n.node.type===s?.type&&Bt(t.doc,r)&&t.join(r),!0},Fs=(t,e,n,r={})=>({editor:s,tr:o,state:i,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:p}=s.extensionManager,h=A(t,i.schema),f=A(e,i.schema),{selection:m,storedMarks:g}=i,{$from:b,$to:y}=m,k=b.blockRange(y),M=g||m.$to.parentOffset&&m.$from.marks();if(!k)return!1;const w=bt(C=>ue(C.type.name,d))(m);if(k.depth>=1&&w&&k.depth-w.depth<=1){if(w.node.type===h)return c.liftListItem(f);if(ue(w.node.type.name,d)&&h.validContent(w.node.content)&&a)return l().command(()=>(o.setNodeMarkup(w.pos,h),!0)).command(()=>Tt(o,h)).command(()=>St(o,h)).run()}return!n||!M||!a?l().command(()=>u().wrapInList(h,r)?!0:c.clearNodes()).wrapInList(h,r).command(()=>Tt(o,h)).command(()=>St(o,h)).run():l().command(()=>{const C=u().wrapInList(h,r),x=M.filter($=>p.includes($.type.name));return o.ensureMarks(x),C?!0:c.clearNodes()}).wrapInList(h,r).command(()=>Tt(o,h)).command(()=>St(o,h)).run()},Vs=(t,e={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:o=!1}=n,i=H(t,r.schema);return Lt(r,i,e)?s.unsetMark(i,{extendEmptyMarkRange:o}):s.setMark(i,e)},Ws=(t,e,n={})=>({state:r,commands:s})=>{const o=A(t,r.schema),i=A(e,r.schema),a=z(r,o,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?s.setNode(i,l):s.setNode(o,{...l,...n})},Us=(t,e={})=>({state:n,commands:r})=>{const s=A(t,n.schema);return z(n,s,e)?r.lift(s):r.wrapIn(s,e)},Ks=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let o;if(s.spec.isInputRules&&(o=s.getState(t))){if(e){const i=t.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)i.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,t.schema.text(o.text,l))}else i.delete(o.from,o.to)}return!0}}return!1},qs=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:s}=n;return r||e&&s.forEach(o=>{t.removeMark(o.$from.pos,o.$to.pos)}),!0},Gs=(t,e={})=>({tr:n,state:r,dispatch:s})=>{var o;const{extendEmptyMarkRange:i=!1}=e,{selection:a}=n,l=H(t,r.schema),{$from:c,empty:u,ranges:d}=a;if(!s)return!0;if(u&&i){let{from:p,to:h}=a;const f=(o=c.marks().find(g=>g.type===l))==null?void 0:o.attrs,m=jt(c,l,f);m&&(p=m.from,h=m.to),n.removeMark(p,h,l)}else d.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,l)});return n.removeStoredMark(l),!0},Js=(t,e={})=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=gt(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(o=A(t,r.schema)),a==="mark"&&(i=H(t,r.schema)),s&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,p,h,f;n.selection.empty?r.doc.nodesBetween(c,u,(m,g)=>{o&&o===m.type&&(h=Math.max(g,c),f=Math.min(g+m.nodeSize,u),d=g,p=m)}):r.doc.nodesBetween(c,u,(m,g)=>{g<c&&o&&o===m.type&&(h=Math.max(g,c),f=Math.min(g+m.nodeSize,u),d=g,p=m),g>=c&&g<=u&&(o&&o===m.type&&n.setNodeMarkup(g,void 0,{...m.attrs,...e}),i&&m.marks.length&&m.marks.forEach(b=>{if(i===b.type){const y=Math.max(g,c),k=Math.min(g+m.nodeSize,u);n.addMark(y,k,i.create({...b.attrs,...e}))}}))}),p&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...p.attrs,...e}),i&&p.marks.length&&p.marks.forEach(m=>{i===m.type&&n.addMark(h,f,i.create({...m.attrs,...e}))}))}),!0):!1},Xs=(t,e={})=>({state:n,dispatch:r})=>{const s=A(t,n.schema);return er(s,e)(n,r)},Ys=(t,e={})=>({state:n,dispatch:r})=>{const s=A(t,n.schema);return nr(s,e)(n,r)},Zs=class{constructor(){this.callbacks={}}on(t,e){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(e),this}emit(t,...e){const n=this.callbacks[t];return n&&n.forEach(r=>r.apply(this,e)),this}off(t,e){const n=this.callbacks[t];return n&&(e?this.callbacks[t]=n.filter(r=>r!==e):delete this.callbacks[t]),this}once(t,e){const n=(...r)=>{this.off(t,n),e.apply(this,r)};return this.on(t,n)}removeAllListeners(){this.callbacks={}}},vt=class{constructor(t){var e;this.find=t.find,this.handler=t.handler,this.undoable=(e=t.undoable)!=null?e:!0}},Qs=(t,e)=>{if(Dt(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function st(t){var e;const{editor:n,from:r,to:s,text:o,rules:i,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(e=c.nodeBefore||c.nodeAfter)!=null&&e.marks.find(p=>p.type.spec.code))return!1;let u=!1;const d=Ls(c)+o;return i.forEach(p=>{if(u)return;const h=Qs(d,p.find);if(!h)return;const f=l.state.tr,m=ft({state:l.state,transaction:f}),g={from:r-(h[0].length-o.length),to:s},{commands:b,chain:y,can:k}=new mt({editor:n,state:m});p.handler({state:m,range:g,match:h,commands:b,chain:y,can:k})===null||!f.steps.length||(p.undoable&&f.setMeta(a,{transform:f,from:r,to:s,text:o}),l.dispatch(f),u=!0)}),u}function to(t){const{editor:e,rules:n}=t,r=new I({state:{init(){return null},apply(s,o,i){const a=s.getMeta(r);if(a)return a;const l=s.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=Vt(j.from(u),i.schema);const{from:d}=l,p=d+u.length;st({editor:e,from:d,to:p,text:u,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:o}},props:{handleTextInput(s,o,i,a){return st({editor:e,from:o,to:i,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:o}=s.state.selection;o&&st({editor:e,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,o){if(o.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?st({editor:e,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function eo(t){return Object.prototype.toString.call(t).slice(8,-1)}function ot(t){return eo(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Ve(t,e){const n={...t};return ot(t)&&ot(e)&&Object.keys(e).forEach(r=>{ot(e[r])&&ot(t[r])?n[r]=Ve(t[r],e[r]):n[r]=e[r]}),n}var Kt=class{constructor(t={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...t},this.name=this.config.name}get options(){return{...T(v(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...T(v(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(t={}){const e=this.extend({...this.config,addOptions:()=>Ve(this.options,t)});return e.name=this.name,e.parent=this.parent,e}extend(t={}){const e=new this.constructor({...this.config,...t});return e.parent=this,this.child=e,e.name="name"in t?t.name:e.parent.name,e}},F=class We extends Kt{constructor(){super(...arguments),this.type="mark"}static create(e={}){const n=typeof e=="function"?e():e;return new We(n)}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(c=>c?.type.name===n.name))return!1;const l=i.find(c=>c?.type.name===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function no(t){return typeof t=="number"}var Ue=class{constructor(t){this.find=t.find,this.handler=t.handler}},ro=(t,e,n)=>{if(Dt(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(s=>{const o=[s.text];return o.index=s.index,o.input=t,o.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(s.replaceWith)),o}):[]};function so(t){const{editor:e,state:n,from:r,to:s,rule:o,pasteEvent:i,dropEvent:a}=t,{commands:l,chain:c,can:u}=new mt({editor:e,state:n}),d=[];return n.doc.nodesBetween(r,s,(h,f)=>{var m,g,b,y,k;if((g=(m=h.type)==null?void 0:m.spec)!=null&&g.code||!(h.isText||h.isTextblock||h.isInline))return;const M=(k=(y=(b=h.content)==null?void 0:b.size)!=null?y:h.nodeSize)!=null?k:0,w=Math.max(r,f),C=Math.min(s,f+M);if(w>=C)return;const x=h.isText?h.text||"":h.textBetween(w-f,C-f,void 0,"ï¿¼");ro(x,o.find,i).forEach(R=>{if(R.index===void 0)return;const V=w+R.index+1,wt=V+R[0].length,nt={from:n.tr.mapping.map(V),to:n.tr.mapping.map(wt)},Mt=o.handler({state:n,range:nt,match:R,commands:l,chain:c,can:u,pasteEvent:i,dropEvent:a});d.push(Mt)})}),d.every(h=>h!==null)}var it=null,oo=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)==null||e.setData("text/html",t),n};function io(t){const{editor:e,rules:n}=t;let r=null,s=!1,o=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:p,rule:h,pasteEvt:f})=>{const m=u.tr,g=ft({state:u,transaction:m});if(!(!so({editor:e,state:g,from:Math.max(d-1,0),to:p.b-1,rule:h,pasteEvent:f,dropEvent:a})||!m.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return n.map(u=>new I({view(d){const p=f=>{var m;r=(m=d.dom.parentElement)!=null&&m.contains(f.target)?d.dom.parentElement:null,r&&(it=e)},h=()=>{it&&(it=null)};return window.addEventListener("dragstart",p),window.addEventListener("dragend",h),{destroy(){window.removeEventListener("dragstart",p),window.removeEventListener("dragend",h)}}},props:{handleDOMEvents:{drop:(d,p)=>{if(o=r===d.dom.parentElement,a=p,!o){const h=it;h?.isEditable&&setTimeout(()=>{const f=h.state.selection;f&&h.commands.deleteRange({from:f.from,to:f.to})},10)}return!1},paste:(d,p)=>{var h;const f=(h=p.clipboardData)==null?void 0:h.getData("text/html");return i=p,s=!!f?.includes("data-pm-slice"),!1}}},appendTransaction:(d,p,h)=>{const f=d[0],m=f.getMeta("uiEvent")==="paste"&&!s,g=f.getMeta("uiEvent")==="drop"&&!o,b=f.getMeta("applyPasteRules"),y=!!b;if(!m&&!g&&!y)return;if(y){let{text:w}=b;typeof w=="string"?w=w:w=Vt(j.from(w),h.schema);const{from:C}=b,x=C+w.length,$=oo(w);return l({rule:u,state:h,from:C,to:{b:x},pasteEvt:$})}const k=p.doc.content.findDiffStart(h.doc.content),M=p.doc.content.findDiffEnd(h.doc.content);if(!(!no(k)||!M||k===M.b))return l({rule:u,state:h,from:k,to:M,pasteEvt:i})}}))}var kt=class{constructor(t,e){this.splittableMarks=[],this.editor=e,this.baseExtensions=t,this.extensions=Oe(t),this.schema=Ms(this.extensions,e),this.setupExtensions()}get commands(){return this.extensions.reduce((t,e)=>{const n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Ct(e.name,this.schema)},r=v(e,"addCommands",n);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this;return Wt([...this.extensions].reverse()).flatMap(r=>{const s={name:r.name,options:r.options,storage:this.editor.extensionStorage[r.name],editor:t,type:Ct(r.name,this.schema)},o=[],i=v(r,"addKeyboardShortcuts",s);let a={};if(r.type==="mark"&&v(r,"exitable",s)&&(a.ArrowRight=()=>F.handleExit({editor:t,mark:r})),i){const p=Object.fromEntries(Object.entries(i()).map(([h,f])=>[h,()=>f({editor:t})]));a={...a,...p}}const l=$n(a);o.push(l);const c=v(r,"addInputRules",s);if(ce(r,t.options.enableInputRules)&&c){const p=c();if(p&&p.length){const h=to({editor:t,rules:p}),f=Array.isArray(h)?h:[h];o.push(...f)}}const u=v(r,"addPasteRules",s);if(ce(r,t.options.enablePasteRules)&&u){const p=u();if(p&&p.length){const h=io({editor:t,rules:p});o.push(...h)}}const d=v(r,"addProseMirrorPlugins",s);if(d){const p=d();o.push(...p)}return o})}get attributes(){return Be(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:e}=Q(this.extensions);return Object.fromEntries(e.filter(n=>!!v(n,"addNodeView")).map(n=>{const r=this.attributes.filter(a=>a.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:A(n.name,this.schema)},o=v(n,"addNodeView",s);if(!o)return[];const i=(a,l,c,u,d)=>{const p=pt(a,r);return o()({node:a,view:l,getPos:c,decorations:u,innerDecorations:d,editor:t,extension:n,HTMLAttributes:p})};return[n.name,i]}))}get markViews(){const{editor:t}=this,{markExtensions:e}=Q(this.extensions);return Object.fromEntries(e.filter(n=>!!v(n,"addMarkView")).map(n=>{const r=this.attributes.filter(a=>a.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:t,type:H(n.name,this.schema)},o=v(n,"addMarkView",s);if(!o)return[];const i=(a,l,c)=>{const u=pt(a,r);return o()({mark:a,view:l,inline:c,editor:t,extension:n,HTMLAttributes:u,updateAttributes:d=>{vo(a,t,d)}})};return[n.name,i]}))}setupExtensions(){const t=this.extensions;this.editor.extensionStorage=Object.fromEntries(t.map(e=>[e.name,e.storage])),t.forEach(e=>{var n;const r={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:Ct(e.name,this.schema)};e.type==="mark"&&((n=T(v(e,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(e.name);const s=v(e,"onBeforeCreate",r),o=v(e,"onCreate",r),i=v(e,"onUpdate",r),a=v(e,"onSelectionUpdate",r),l=v(e,"onTransaction",r),c=v(e,"onFocus",r),u=v(e,"onBlur",r),d=v(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),o&&this.editor.on("create",o),i&&this.editor.on("update",i),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}};kt.resolve=Oe;kt.sort=Wt;kt.flatten=Ft;var ao={};Ht(ao,{ClipboardTextSerializer:()=>qe,Commands:()=>Ge,Delete:()=>Je,Drop:()=>Xe,Editable:()=>Ye,FocusEvents:()=>Qe,Keymap:()=>tn,Paste:()=>en,Tabindex:()=>nn,focusEventsPluginKey:()=>Ze});var S=class Ke extends Kt{constructor(){super(...arguments),this.type="extension"}static create(e={}){const n=typeof e=="function"?e():e;return new Ke(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}},qe=S.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new I({key:new _("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:s}=e,{ranges:o}=s,i=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=De(n);return He(r,{from:i,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),Ge=S.create({name:"commands",addCommands(){return{...Se}}}),Je=S.create({name:"delete",onUpdate({transaction:t,appendedTransactions:e}){var n,r,s;const o=()=>{var i,a,l,c;if((c=(l=(a=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,t))!=null?c:t.getMeta("y-sync$"))return;const u=_e(t.before,[t,...e]);ze(u).forEach(h=>{u.mapping.mapResult(h.oldRange.from).deletedAfter&&u.mapping.mapResult(h.oldRange.to).deletedBefore&&u.before.nodesBetween(h.oldRange.from,h.oldRange.to,(f,m)=>{const g=m+f.nodeSize-2,b=h.oldRange.from<=m&&g<=h.oldRange.to;this.editor.emit("delete",{type:"node",node:f,from:m,to:g,newFrom:u.mapping.map(m),newTo:u.mapping.map(g),deletedRange:h.oldRange,newRange:h.newRange,partial:!b,editor:this.editor,transaction:t,combinedTransform:u})})});const p=u.mapping;u.steps.forEach((h,f)=>{var m,g;if(h instanceof En){const b=p.slice(f).map(h.from,-1),y=p.slice(f).map(h.to),k=p.invert().map(b,-1),M=p.invert().map(y),w=(m=u.doc.nodeAt(b-1))==null?void 0:m.marks.some(x=>x.eq(h.mark)),C=(g=u.doc.nodeAt(y))==null?void 0:g.marks.some(x=>x.eq(h.mark));this.editor.emit("delete",{type:"mark",mark:h.mark,from:h.from,to:h.to,deletedRange:{from:k,to:M},newRange:{from:b,to:y},partial:!!(C||w),editor:this.editor,transaction:t,combinedTransform:u})}})};(s=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||s?setTimeout(o,0):o()}}),Xe=S.create({name:"drop",addProseMirrorPlugins(){return[new I({key:new _("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),Ye=S.create({name:"editable",addProseMirrorPlugins(){return[new I({key:new _("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Ze=new _("focusEvents"),Qe=S.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new I({key:Ze,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),tn=S.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:p,parent:h}=d,f=d.parent.isTextblock&&p>0?a.doc.resolve(p-1):d,m=f.parent.type.spec.isolating,g=d.pos-d.parentOffset,b=m&&f.parent.childCount===1?g===d.pos:K.atStart(c).from===p;return!u||!h.type.isTextblock||h.textContent.length||!b||b&&d.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},o={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return zt()||Ie()?o:s},addProseMirrorPlugins(){return[new I({key:new _("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(m=>m.getMeta("composition")))return;const r=t.some(m=>m.docChanged)&&!e.doc.eq(n.doc),s=t.some(m=>m.getMeta("preventClearDocument"));if(!r||s)return;const{empty:o,from:i,to:a}=e.selection,l=K.atStart(e.doc).from,c=K.atEnd(e.doc).to;if(o||!(i===l&&a===c)||!yt(n.doc))return;const p=n.tr,h=ft({state:n,transaction:p}),{commands:f}=new mt({editor:this.editor,state:h});if(f.clearNodes(),!!p.steps.length)return p}})]}}),en=S.create({name:"paste",addProseMirrorPlugins(){return[new I({key:new _("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),nn=S.create({name:"tabindex",addProseMirrorPlugins(){return[new I({key:new _("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),lo=class J{constructor(e,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!=null?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You canât set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new J(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new J(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new J(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,i=this.pos+r+(o?0:1);if(i<0||i>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(i);if(!s&&a.depth<=this.depth)return;const l=new J(a,this.editor,s,s?n:null);s&&(l.actualDepth=this.depth+1),e.push(new J(a,this.editor,s,s?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(n).length>0){const o=s.node.attrs,i=Object.keys(n);for(let a=0;a<i.length;a+=1){const l=i[a];if(o[l]!==n[l])break}}else r=s;s=s.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const o=Object.keys(n);return this.children.forEach(i=>{r&&s.length>0||(i.node.type.name===e&&o.every(l=>n[l]===i.node.attrs[l])&&s.push(i),!(r&&s.length>0)&&(s=s.concat(i.querySelectorAll(e,n,r))))}),s}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}},co=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function uo(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(s),s}var po=class extends Zs{constructor(t={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:r})=>{throw r},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:r,slice:s,moved:o})=>this.options.onDrop(r,s,o)),this.on("paste",({event:r,slice:s})=>this.options.onPaste(r,s)),this.on("delete",this.options.onDelete);const e=this.createDoc(),n=Le(e,this.options.autofocus);this.editorState=An.create({doc:e,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){const t=this.editorView.dom;t?.editor&&delete t.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{typeof this.css.remove=="function"?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(t){console.warn("Failed to remove CSS element:",t)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=uo(co,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,e=!0){this.setOptions({editable:t}),e&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.dispatchTransaction(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,e)=>{if(this.editorView)return this.editorView[e];if(e==="state")return this.editorState;if(e in t)return Reflect.get(t,e);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${e}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,e){const n=Re(e)?e(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(t){if(this.isDestroyed)return;const e=this.state.plugins;let n=e;if([].concat(t).forEach(s=>{const o=typeof s=="string"?`${s}$`:s.key;n=n.filter(i=>!i.key.startsWith(o))}),e.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var t,e;const r=[...this.options.enableCoreExtensions?[Ye,qe.configure({blockSeparator:(e=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:e.blockSeparator}),Ge,Qe,tn,nn,Xe,en,Je].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s?.type));this.extensionManager=new kt(r,this)}createCommandManager(){this.commandManager=new mt({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=At(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(e){if(!(e instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(e.message))throw e;this.emit("contentError",{editor:this,error:e,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(n=>n.name!=="collaboration"),this.createExtensionManager()}}),t=At(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){var e;this.editorView=new Ln(t,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)==null?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});const n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const e=this.capturedTransaction;return this.capturedTransaction=null,e}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(c=>{var u;return(u=this.capturedTransaction)==null?void 0:u.step(c)});return}const{state:e,transactions:n}=this.state.applyTransaction(t),r=!this.state.selection.eq(e.selection),s=n.includes(t),o=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:e}),!s)return;this.view.updateState(e),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=n.findLast(c=>c.getMeta("focus")||c.getMeta("blur")),a=i?.getMeta("focus"),l=i?.getMeta("blur");a&&this.emit("focus",{editor:this,event:a.event,transaction:i}),l&&this.emit("blur",{editor:this,event:l.event,transaction:i}),!(t.getMeta("preventUpdate")||!n.some(c=>c.docChanged)||o.doc.eq(e.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:n.slice(1)})}getAttributes(t){return je(this.state,t)}isActive(t,e){const n=typeof t=="string"?t:null,r=typeof t=="string"?e:t;return $s(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Vt(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:e=`

`,textSerializers:n={}}=t||{};return Cs(this.state.doc,{blockSeparator:e,textSerializers:{...De(this.schema),...n}})}get isEmpty(){return yt(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,e;return(e=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?e:!0}$node(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelector(t,e))||null}$nodes(t,e){var n;return((n=this.$doc)==null?void 0:n.querySelectorAll(t,e))||null}$pos(t){const e=this.state.doc.resolve(t);return new lo(e,this)}get $doc(){return this.$pos(0)}};function X(t){return new vt({find:t.find,handler:({state:e,range:n,match:r})=>{const s=T(t.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:o}=e,i=r[r.length-1],a=r[0];if(i){const l=a.search(/\S/),c=n.from+a.indexOf(i),u=c+i.length;if(Ut(n.from,n.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===t.type&&m!==h.mark.type)).filter(h=>h.to>c).length)return null;u<n.to&&o.delete(u,n.to),c>n.from&&o.delete(n.from+l,c);const p=n.from+l+i.length;o.addMark(n.from+l,p,t.type.create(s||{})),o.removeStoredMark(t.type)}},undoable:t.undoable})}function rn(t){return new vt({find:t.find,handler:({state:e,range:n,match:r})=>{const s=T(t.getAttributes,void 0,r)||{},{tr:o}=e,i=n.from;let a=n.to;const l=t.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=i+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,i+r[0].length-1),o.replaceWith(u,a,l)}else if(r[0]){const c=t.type.isInline?i:i-1;o.insert(c,t.type.create(s)).delete(o.mapping.map(i),o.mapping.map(a))}o.scrollIntoView()},undoable:t.undoable})}function $t(t){return new vt({find:t.find,handler:({state:e,range:n,match:r})=>{const s=e.doc.resolve(n.from),o=T(t.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,o)},undoable:t.undoable})}function Y(t){return new vt({find:t.find,handler:({state:e,range:n,match:r,chain:s})=>{const o=T(t.getAttributes,void 0,r)||{},i=e.tr.delete(n.from,n.to),l=i.doc.resolve(n.from).blockRange(),c=l&&Tn(l,t.type,o);if(!c)return null;if(i.wrap(l,c),t.keepMarks&&t.editor){const{selection:d,storedMarks:p}=e,{splittableMarks:h}=t.editor.extensionManager,f=p||d.$to.parentOffset&&d.$from.marks();if(f){const m=f.filter(g=>h.includes(g.type.name));i.ensureMarks(m)}}if(t.keepAttributes){const d=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(d,o).run()}const u=i.doc.resolve(n.from-1).nodeBefore;u&&u.type===t.type&&Bt(i.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,u))&&i.join(n.from-1)},undoable:t.undoable})}function ho(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof tt){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let s=r.depth;for(;s>=0;){const o=r.index(s);if(r.node(s).contentMatchAt(o).matchType(e))return!0;s-=1}return!1}var fo={};Ht(fo,{createAtomBlockMarkdownSpec:()=>sn,createBlockMarkdownSpec:()=>mo,createInlineMarkdownSpec:()=>yo,parseAttributes:()=>qt,parseIndentedBlocks:()=>It,renderNestedMarkdownContent:()=>Jt,serializeAttributes:()=>Gt});function qt(t){if(!t?.trim())return{};const e={},n=[],r=t.replace(/["']([^"']*)["']/g,c=>(n.push(c),`__QUOTED_${n.length-1}__`)),s=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);if(s){const c=s.map(u=>u.trim().slice(1));e.class=c.join(" ")}const o=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);o&&(e.id=o[1]);const i=/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g;Array.from(r.matchAll(i)).forEach(([,c,u])=>{var d;const p=parseInt(((d=u.match(/__QUOTED_(\d+)__/))==null?void 0:d[1])||"0",10),h=n[p];h&&(e[c]=h.slice(1,-1))});const l=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return l&&l.split(/\s+/).filter(Boolean).forEach(u=>{u.match(/^[a-zA-Z][\w-]*$/)&&(e[u]=!0)}),e}function Gt(t){if(!t||Object.keys(t).length===0)return"";const e=[];return t.class&&String(t.class).split(/\s+/).filter(Boolean).forEach(r=>e.push(`.${r}`)),t.id&&e.push(`#${t.id}`),Object.entries(t).forEach(([n,r])=>{n==="class"||n==="id"||(r===!0?e.push(n):r!==!1&&r!=null&&e.push(`${n}="${String(r)}"`))}),e.join(" ")}function sn(t){const{nodeName:e,name:n,parseAttributes:r=qt,serializeAttributes:s=Gt,defaultAttributes:o={},requiredAttributes:i=[],allowedAttributes:a}=t,l=n||e,c=u=>{if(!a)return u;const d={};return a.forEach(p=>{p in u&&(d[p]=u[p])}),d};return{parseMarkdown:(u,d)=>{const p={...o,...u.attributes};return d.createNode(e,p,[])},markdownTokenizer:{name:e,level:"block",start(u){var d;const p=new RegExp(`^:::${l}(?:\\s|$)`,"m"),h=(d=u.match(p))==null?void 0:d.index;return h!==void 0?h:-1},tokenize(u,d,p){const h=new RegExp(`^:::${l}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),f=u.match(h);if(!f)return;const m=f[1]||"",g=r(m);if(!i.find(y=>!(y in g)))return{type:e,raw:f[0],attributes:g}}},renderMarkdown:u=>{const d=c(u.attrs||{}),p=s(d),h=p?` {${p}}`:"";return`:::${l}${h} :::`}}}function mo(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=qt,serializeAttributes:o=Gt,defaultAttributes:i={},content:a="block",allowedAttributes:l}=t,c=n||e,u=d=>{if(!l)return d;const p={};return l.forEach(h=>{h in d&&(p[h]=d[h])}),p};return{parseMarkdown:(d,p)=>{let h;if(r){const m=r(d);h=typeof m=="string"?[{type:"text",text:m}]:m}else a==="block"?h=p.parseChildren(d.tokens||[]):h=p.parseInline(d.tokens||[]);const f={...i,...d.attributes};return p.createNode(e,f,h)},markdownTokenizer:{name:e,level:"block",start(d){var p;const h=new RegExp(`^:::${c}`,"m"),f=(p=d.match(h))==null?void 0:p.index;return f!==void 0?f:-1},tokenize(d,p,h){var f;const m=new RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),g=d.match(m);if(!g)return;const[b,y=""]=g,k=s(y);let M=1;const w=b.length;let C="";const x=/^:::([\w-]*)(\s.*)?/gm,$=d.slice(w);for(x.lastIndex=0;;){const R=x.exec($);if(R===null)break;const V=R.index,wt=R[1];if(!((f=R[2])!=null&&f.endsWith(":::"))){if(wt)M+=1;else if(M-=1,M===0){const nt=$.slice(0,V);C=nt.trim();const Mt=d.slice(0,w+V+R[0].length);let D=[];if(C)if(a==="block")for(D=h.blockTokens(nt),D.forEach(O=>{O.text&&(!O.tokens||O.tokens.length===0)&&(O.tokens=h.inlineTokens(O.text))});D.length>0;){const O=D[D.length-1];if(O.type==="paragraph"&&(!O.text||O.text.trim()===""))D.pop();else break}else D=h.inlineTokens(C);return{type:e,raw:Mt,attributes:k,content:C,tokens:D}}}}}},renderMarkdown:(d,p)=>{const h=u(d.attrs||{}),f=o(h),m=f?` {${f}}`:"",g=p.renderChildren(d.content||[],`

`);return`:::${c}${m}

${g}

:::`}}}function go(t){if(!t.trim())return{};const e={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g;let r=n.exec(t);for(;r!==null;){const[,s,o,i]=r;e[s]=o||i,r=n.exec(t)}return e}function bo(t){return Object.entries(t).filter(([,e])=>e!=null).map(([e,n])=>`${e}="${n}"`).join(" ")}function yo(t){const{nodeName:e,name:n,getContent:r,parseAttributes:s=go,serializeAttributes:o=bo,defaultAttributes:i={},selfClosing:a=!1,allowedAttributes:l}=t,c=n||e,u=p=>{if(!l)return p;const h={};return l.forEach(f=>{f in p&&(h[f]=p[f])}),h},d=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(p,h)=>{const f={...i,...p.attributes};if(a)return h.createNode(e,f);const m=r?r(p):p.content||"";return m?h.createNode(e,f,[h.createTextNode(m)]):h.createNode(e,f,[])},markdownTokenizer:{name:e,level:"inline",start(p){const h=a?new RegExp(`\\[${d}\\s*[^\\]]*\\]`):new RegExp(`\\[${d}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${d}\\]`),f=p.match(h),m=f?.index;return m!==void 0?m:-1},tokenize(p,h,f){const m=a?new RegExp(`^\\[${d}\\s*([^\\]]*)\\]`):new RegExp(`^\\[${d}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${d}\\]`),g=p.match(m);if(!g)return;let b="",y="";if(a){const[,M]=g;y=M}else{const[,M,w]=g;y=M,b=w||""}const k=s(y.trim());return{type:e,raw:g[0],content:b.trim(),attributes:k}}},renderMarkdown:p=>{let h="";r?h=r(p):p.content&&p.content.length>0&&(h=p.content.filter(b=>b.type==="text").map(b=>b.text).join(""));const f=u(p.attrs||{}),m=o(f),g=m?` ${m}`:"";return a?`[${c}${g}]`:`[${c}${g}]${h}[/${c}]`}}}function It(t,e,n){var r,s,o,i;const a=t.split(`
`),l=[];let c="",u=0;const d=e.baseIndentSize||2;for(;u<a.length;){const p=a[u],h=p.match(e.itemPattern);if(!h){if(l.length>0)break;if(p.trim()===""){u+=1;continue}else return}const f=e.extractItemData(h),{indentLevel:m,mainContent:g}=f;c=`${c}${p}
`;const b=[g];for(u+=1;u<a.length;){const w=a[u];if(w.trim()===""){const x=a.slice(u+1).findIndex(V=>V.trim()!=="");if(x===-1)break;if((((s=(r=a[u+1+x].match(/^(\s*)/))==null?void 0:r[1])==null?void 0:s.length)||0)>m){b.push(w),c=`${c}${w}
`,u+=1;continue}else break}if((((i=(o=w.match(/^(\s*)/))==null?void 0:o[1])==null?void 0:i.length)||0)>m)b.push(w),c=`${c}${w}
`,u+=1;else break}let y;const k=b.slice(1);if(k.length>0){const w=k.map(C=>C.slice(m+d)).join(`
`);w.trim()&&(e.customNestedParser?y=e.customNestedParser(w):y=n.blockTokens(w))}const M=e.createToken(f,y);l.push(M)}if(l.length!==0)return{items:l,raw:c.trim()}}function Jt(t,e,n,r){if(!t||!Array.isArray(t.content))return"";const s=typeof n=="function"?n(r):n,[o,...i]=t.content,a=e.renderChildren([o]),l=[`${s}${a}`];return i&&i.length>0&&i.forEach(c=>{const u=e.renderChildren([c]);if(u){const d=u.split(`
`).map(p=>p?e.indent(p):"").join(`
`);l.push(d)}}),l.join(`
`)}function vo(t,e,n={}){const{state:r}=e,{doc:s,tr:o}=r,i=t;s.descendants((a,l)=>{const c=o.mapping.map(l),u=o.mapping.map(l)+a.nodeSize;let d=null;if(a.marks.forEach(h=>{if(h!==i)return!1;d=h}),!d)return;let p=!1;if(Object.keys(n).forEach(h=>{n[h]!==d.attrs[h]&&(p=!0)}),p){const h=t.type.create({...t.attrs,...n});o.removeMark(c,u,t.type),o.addMark(c,u,h)}}),o.docChanged&&e.view.dispatch(o)}var L=class on extends Kt{constructor(){super(...arguments),this.type="node"}static create(e={}){const n=typeof e=="function"?e():e;return new on(n)}configure(e){return super.configure(e)}extend(e){const n=typeof e=="function"?e():e;return super.extend(n)}};function G(t){return new Ue({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:s})=>{const o=T(t.getAttributes,void 0,r,s);if(o===!1||o===null)return null;const{tr:i}=e,a=r[r.length-1],l=r[0];let c=n.to;if(a){const u=l.search(/\S/),d=n.from+l.indexOf(a),p=d+a.length;if(Ut(n.from,n.to,e.doc).filter(f=>f.mark.type.excluded.find(g=>g===t.type&&g!==f.mark.type)).filter(f=>f.to>d).length)return null;p<n.to&&i.delete(p,n.to),d>n.from&&i.delete(n.from+u,d),c=n.from+u+a.length,i.addMark(n.from+u,c,t.type.create(o||{})),i.removeStoredMark(t.type)}}})}function ko(t){return new Ue({find:t.find,handler({match:e,chain:n,range:r,pasteEvent:s}){const o=T(t.getAttributes,void 0,e,s),i=T(t.getContent,void 0,o);if(o===!1||o===null)return null;const a={type:t.type.name,attrs:o};i&&(a.content=i),e.input&&n().deleteRange(r).insertContentAt(r.from,a)}})}var wo=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},Mo=({contentComponent:t})=>{const e=xe.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return B.jsx(B.Fragment,{children:Object.values(e)})};function xo(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:ar.createPortal(r.reactElement,r.element,n)},t.forEach(s=>s())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(s=>s())}}}var Co=class extends q.Component{constructor(t){var e;super(t),this.editorContentRef=q.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((e=t.editor)!=null&&e.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const t=this.props.editor;if(t&&!t.isDestroyed&&t.options.element){if(t.contentComponent)return;const e=this.editorContentRef.current;e.append(t.view.dom),t.setOptions({element:e}),t.contentComponent=xo(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(n=>n.hasContentComponentInitialized?n:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var t;const e=this.props.editor;if(e){this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null;try{if(!((t=e.view.dom)!=null&&t.firstChild))return;const n=document.createElement("div");n.append(e.view.dom),e.setOptions({element:n})}catch{}}}render(){const{editor:t,innerRef:e,...n}=this.props;return B.jsxs(B.Fragment,{children:[B.jsx("div",{ref:wo(e,this.editorContentRef),...n}),t?.contentComponent&&B.jsx(Mo,{contentComponent:t.contentComponent})]})}},To=N.forwardRef((t,e)=>{const n=q.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return q.createElement(Co,{key:n,innerRef:e,...t})}),So=q.memo(To),Eo=typeof window<"u"?N.useLayoutEffect:N.useEffect,Ao=class{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",e),()=>{n.off("transaction",e)}}}};function Lo(t){var e;const[n]=N.useState(()=>new Ao(t.editor)),r=or.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!=null?e:ir);return Eo(()=>n.watch(t.editor),[t.editor,n]),N.useDebugValue(r),r}var $o=!1,Pt=typeof window>"u",Io=Pt||!!(typeof window<"u"&&window.next),Po=class an{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Pt||Io?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var s,o;return(o=(s=this.options.current).onBeforeCreate)==null?void 0:o.call(s,...r)},onBlur:(...r)=>{var s,o;return(o=(s=this.options.current).onBlur)==null?void 0:o.call(s,...r)},onCreate:(...r)=>{var s,o;return(o=(s=this.options.current).onCreate)==null?void 0:o.call(s,...r)},onDestroy:(...r)=>{var s,o;return(o=(s=this.options.current).onDestroy)==null?void 0:o.call(s,...r)},onFocus:(...r)=>{var s,o;return(o=(s=this.options.current).onFocus)==null?void 0:o.call(s,...r)},onSelectionUpdate:(...r)=>{var s,o;return(o=(s=this.options.current).onSelectionUpdate)==null?void 0:o.call(s,...r)},onTransaction:(...r)=>{var s,o;return(o=(s=this.options.current).onTransaction)==null?void 0:o.call(s,...r)},onUpdate:(...r)=>{var s,o;return(o=(s=this.options.current).onUpdate)==null?void 0:o.call(s,...r)},onContentError:(...r)=>{var s,o;return(o=(s=this.options.current).onContentError)==null?void 0:o.call(s,...r)},onDrop:(...r)=>{var s,o;return(o=(s=this.options.current).onDrop)==null?void 0:o.call(s,...r)},onPaste:(...r)=>{var s,o;return(o=(s=this.options.current).onPaste)==null?void 0:o.call(s,...r)},onDelete:(...r)=>{var s,o;return(o=(s=this.options.current).onDelete)==null?void 0:o.call(s,...r)}};return new po(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((s,o)=>{var i;return s===((i=n.extensions)==null?void 0:i[o])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?an.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,s)=>r===e[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}};function _o(t={},e=[]){const n=N.useRef(t);n.current=t;const[r]=N.useState(()=>new Po(n)),s=xe.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return N.useDebugValue(s),N.useEffect(r.onRender(e)),Lo({editor:s,selector:({transactionNumber:o})=>t.shouldRerenderOnTransaction===!1||t.shouldRerenderOnTransaction===void 0?null:t.immediatelyRender&&o===0?0:o+1}),s}var Xt=N.createContext({editor:null}),No=Xt.Consumer,oa=()=>N.useContext(Xt);function ia({children:t,slotAfter:e,slotBefore:n,editorContainerProps:r={},...s}){const o=_o(s),i=N.useMemo(()=>({editor:o}),[o]);return o?B.jsxs(Xt.Provider,{value:i,children:[n,B.jsx(No,{children:({editor:a})=>B.jsx(So,{editor:a,...r})}),t,e]}):null}var Ro=N.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),Bo=()=>N.useContext(Ro);q.forwardRef((t,e)=>{const{onDragStart:n}=Bo(),r=t.as||"div";return B.jsx(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});q.createContext({markViewContentRef:()=>{}});var ht=(t,e)=>{if(t==="slot")return 0;if(t instanceof Function)return t(e);const{children:n,...r}=e??{};if(t==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[t,r,n]},Oo=/^\s*>\s$/,Ho=L.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return ht("blockquote",{...E(this.options.HTMLAttributes,t),children:ht("slot",{})})},parseMarkdown:(t,e)=>e.createNode("blockquote",void 0,e.parseChildren(t.tokens||[])),renderMarkdown:(t,e)=>{if(!t.content)return"";const n=[];return t.content.forEach(s=>{const i=e.renderChildren(s).split(`
`).map(a=>`> ${a}`).join(`
`);n.push(i)}),n.flatMap(s=>[s,"> "]).slice(0,-1).join(`
`)},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Y({find:Oo,type:this.type})]}}),Do=Object.defineProperty,jo=(t,e)=>{for(var n in e)Do(t,n,{get:e[n],enumerable:!0})},zo="listItem",pe="textStyle",he=/^\s*([-+*])\s$/,ln=L.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",E(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>t.type!=="list"||t.ordered?[]:{type:"bulletList",content:t.items?e.parseChildren(t.items):[]},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownOptions:{indentsContent:!0},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(zo,this.editor.getAttributes(pe)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Y({find:he,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Y({find:he,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(pe),editor:this.editor})),[t]}}),cn=L.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",E(this.options.HTMLAttributes,t),0]},markdownTokenName:"list_item",parseMarkdown:(t,e)=>{if(t.type!=="list_item")return[];let n=[];if(t.tokens&&t.tokens.length>0)if(t.tokens.some(s=>s.type==="paragraph"))n=e.parseChildren(t.tokens);else{const s=t.tokens[0];if(s&&s.type==="text"&&s.tokens&&s.tokens.length>0){if(n=[{type:"paragraph",content:e.parseInline(s.tokens)}],t.tokens.length>1){const i=t.tokens.slice(1),a=e.parseChildren(i);n.push(...a)}}else n=e.parseChildren(t.tokens)}return n.length===0&&(n=[{type:"paragraph",content:[]}]),{type:"listItem",content:n}},renderMarkdown:(t,e,n)=>Jt(t,e,r=>r.parentType==="bulletList"?"- ":r.parentType==="orderedList"?`${r.index+1}. `:"- ",n),addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Fo={};jo(Fo,{findListItemPos:()=>et,getNextListDepth:()=>Yt,handleBackspace:()=>_t,handleDelete:()=>Nt,hasListBefore:()=>un,hasListItemAfter:()=>Vo,hasListItemBefore:()=>dn,listItemHasSubList:()=>pn,nextListIsDeeper:()=>hn,nextListIsHigher:()=>fn});var et=(t,e)=>{const{$from:n}=e.selection,r=A(t,e.schema);let s=null,o=n.depth,i=n.pos,a=null;for(;o>0&&a===null;)s=n.node(o),s.type===r?a=o:(o-=1,i-=1);return a===null?null:{$pos:e.doc.resolve(i),depth:a}},Yt=(t,e)=>{const n=et(t,e);if(!n)return!1;const[,r]=As(e,t,n.$pos.pos+4);return r},un=(t,e,n)=>{const{$anchor:r}=t.selection,s=Math.max(0,r.pos-2),o=t.doc.resolve(s).node();return!(!o||!n.includes(o.type.name))},dn=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-2);return!(s.index()===0||((n=s.nodeBefore)==null?void 0:n.type.name)!==t)},pn=(t,e,n)=>{if(!n)return!1;const r=A(t,e.schema);let s=!1;return n.descendants(o=>{o.type===r&&(s=!0)}),s},_t=(t,e,n)=>{if(t.commands.undoInputRule())return!0;if(t.state.selection.from!==t.state.selection.to)return!1;if(!z(t.state,e)&&un(t.state,e,n)){const{$anchor:a}=t.state.selection,l=t.state.doc.resolve(a.before()-1),c=[];l.node().descendants((p,h)=>{p.type.name===e&&c.push({node:p,pos:h})});const u=c.at(-1);if(!u)return!1;const d=t.state.doc.resolve(l.start()+u.pos+1);return t.chain().cut({from:a.start()-1,to:a.end()+1},d.end()).joinForward().run()}if(!z(t.state,e)||!Ps(t.state))return!1;const r=et(e,t.state);if(!r)return!1;const o=t.state.doc.resolve(r.$pos.pos-2).node(r.depth),i=pn(e,t.state,o);return dn(e,t.state)&&!i?t.commands.joinItemBackward():t.chain().liftListItem(e).run()},hn=(t,e)=>{const n=Yt(t,e),r=et(t,e);return!r||!n?!1:n>r.depth},fn=(t,e)=>{const n=Yt(t,e),r=et(t,e);return!r||!n?!1:n<r.depth},Nt=(t,e)=>{if(!z(t.state,e)||!Is(t.state,e))return!1;const{selection:n}=t.state,{$from:r,$to:s}=n;return!n.empty&&r.sameParent(s)?!1:hn(e,t.state)?t.chain().focus(t.state.selection.from+4).lift(e).joinBackward().run():fn(e,t.state)?t.chain().joinForward().joinBackward().run():t.commands.joinItemForward()},Vo=(t,e)=>{var n;const{$anchor:r}=e.selection,s=e.doc.resolve(r.pos-r.parentOffset-2);return!(s.index()===s.parent.childCount-1||((n=s.nodeAfter)==null?void 0:n.type.name)!==t)},mn=S.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Nt(t,n)&&(e=!0)}),e},"Mod-Delete":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n})=>{t.state.schema.nodes[n]!==void 0&&Nt(t,n)&&(e=!0)}),e},Backspace:({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&_t(t,n,r)&&(e=!0)}),e},"Mod-Backspace":({editor:t})=>{let e=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{t.state.schema.nodes[n]!==void 0&&_t(t,n,r)&&(e=!0)}),e}}}}),fe=/^(\s*)(\d+)\.\s+(.*)$/,Wo=/^\s/;function Uo(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n],o=s.match(fe);if(!o)break;const[,i,a,l]=o,c=i.length;let u=l,d=n+1;const p=[s];for(;d<t.length;){const h=t[d];if(h.match(fe))break;if(h.trim()==="")p.push(h),u+=`
`,d+=1;else if(h.match(Wo))p.push(h),u+=`
${h.slice(c+2)}`,d+=1;else break}e.push({indent:c,number:parseInt(a,10),content:u.trim(),raw:p.join(`
`)}),r=d,n=d}return[e,r]}function gn(t,e,n){var r;const s=[];let o=0;for(;o<t.length;){const i=t[o];if(i.indent===e){const a=i.content.split(`
`),l=((r=a[0])==null?void 0:r.trim())||"",c=[];l&&c.push({type:"paragraph",raw:l,tokens:n.inlineTokens(l)});const u=a.slice(1).join(`
`).trim();if(u){const h=n.blockTokens(u);c.push(...h)}let d=o+1;const p=[];for(;d<t.length&&t[d].indent>e;)p.push(t[d]),d+=1;if(p.length>0){const h=Math.min(...p.map(m=>m.indent)),f=gn(p,h,n);c.push({type:"list",ordered:!0,start:p[0].number,items:f,raw:p.map(m=>m.raw).join(`
`)})}s.push({type:"list_item",raw:i.raw,tokens:c}),o=d}else o+=1}return s}function Ko(t,e){return t.map(n=>{if(n.type!=="list_item")return e.parseChildren([n])[0];const r=[];return n.tokens&&n.tokens.length>0&&n.tokens.forEach(s=>{if(s.type==="paragraph"||s.type==="list"||s.type==="blockquote"||s.type==="code")r.push(...e.parseChildren([s]));else if(s.type==="text"&&s.tokens){const o=e.parseChildren([s]);r.push({type:"paragraph",content:o})}else{const o=e.parseChildren([s]);o.length>0&&r.push(...o)}}),{type:"listItem",content:r}})}var qo="listItem",me="textStyle",ge=/^(\d+)\.\s$/,bn=L.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",E(this.options.HTMLAttributes,n),0]:["ol",E(this.options.HTMLAttributes,t),0]},markdownTokenName:"list",parseMarkdown:(t,e)=>{if(t.type!=="list"||!t.ordered)return[];const n=t.start||1,r=t.items?Ko(t.items,e):[];return n!==1?{type:"orderedList",attrs:{start:n},content:r}:{type:"orderedList",content:r}},renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"orderedList",level:"block",start:t=>{const e=t.match(/^(\s*)(\d+)\.\s+/),n=e?.index;return n!==void 0?n:-1},tokenize:(t,e,n)=>{var r;const s=t.split(`
`),[o,i]=Uo(s);if(o.length===0)return;const a=gn(o,0,n);return a.length===0?void 0:{type:"list",ordered:!0,start:((r=o[0])==null?void 0:r.number)||1,items:a,raw:s.slice(0,i).join(`
`)}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(qo,this.editor.getAttributes(me)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Y({find:ge,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Y({find:ge,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(me)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),Go=/^\s*(\[([( |x])?\])\s$/,Jo=L.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:t=>{const e=t.getAttribute("data-checked");return e===""||e==="true"},renderHTML:t=>({"data-checked":t.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:t,HTMLAttributes:e}){return["li",E(this.options.HTMLAttributes,e,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:t.attrs.checked?"checked":null}],["span"]],["div",0]]},parseMarkdown:(t,e)=>{const n=[];if(t.tokens&&t.tokens.length>0?n.push(e.createNode("paragraph",{},e.parseInline(t.tokens))):t.text?n.push(e.createNode("paragraph",{},[e.createNode("text",{text:t.text})])):n.push(e.createNode("paragraph",{},[])),t.nestedTokens&&t.nestedTokens.length>0){const r=e.parseChildren(t.nestedTokens);n.push(...r)}return e.createNode("taskItem",{checked:t.checked||!1},n)},renderMarkdown:(t,e)=>{var n;const s=`- [${(n=t.attrs)!=null&&n.checked?"x":" "}] `;return Jt(t,e,s)},addKeyboardShortcuts(){const t={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...t,Tab:()=>this.editor.commands.sinkListItem(this.name)}:t},addNodeView(){return({node:t,HTMLAttributes:e,getPos:n,editor:r})=>{const s=document.createElement("li"),o=document.createElement("label"),i=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),c=u=>{var d,p;a.ariaLabel=((p=(d=this.options.a11y)==null?void 0:d.checkboxLabel)==null?void 0:p.call(d,u,a.checked))||`Task item checkbox for ${u.textContent||"empty task item"}`};return c(t),o.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",u=>u.preventDefault()),a.addEventListener("change",u=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:d}=u.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:p})=>{const h=n();if(typeof h!="number")return!1;const f=p.doc.nodeAt(h);return p.setNodeMarkup(h,void 0,{...f?.attrs,checked:d}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(t,d)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([u,d])=>{s.setAttribute(u,d)}),s.dataset.checked=t.attrs.checked,a.checked=t.attrs.checked,o.append(a,i),s.append(o,l),Object.entries(e).forEach(([u,d])=>{s.setAttribute(u,d)}),{dom:s,contentDOM:l,update:u=>u.type!==this.type?!1:(s.dataset.checked=u.attrs.checked,a.checked=u.attrs.checked,c(u),!0)}}},addInputRules(){return[Y({find:Go,type:this.type,getAttributes:t=>({checked:t[t.length-1]==="x"})})]}}),Xo=L.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:t}){return["ul",E(this.options.HTMLAttributes,t,{"data-type":this.name}),0]},parseMarkdown:(t,e)=>e.createNode("taskList",{},e.parseChildren(t.items||[])),renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`
`):"",markdownTokenizer:{name:"taskList",level:"block",start(t){var e;const n=(e=t.match(/^\s*[-+*]\s+\[([ xX])\]\s+/))==null?void 0:e.index;return n!==void 0?n:-1},tokenize(t,e,n){const r=o=>{const i=It(o,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:a=>({indentLevel:a[1].length,mainContent:a[4],checked:a[3].toLowerCase()==="x"}),createToken:(a,l)=>({type:"taskItem",raw:"",mainContent:a.mainContent,indentLevel:a.indentLevel,checked:a.checked,text:a.mainContent,tokens:n.inlineTokens(a.mainContent),nestedTokens:l}),customNestedParser:r},n);return i?[{type:"taskList",raw:i.raw,items:i.items}]:n.blockTokens(o)},s=It(t,{itemPattern:/^(\s*)([-+*])\s+\[([ xX])\]\s+(.*)$/,extractItemData:o=>({indentLevel:o[1].length,mainContent:o[4],checked:o[3].toLowerCase()==="x"}),createToken:(o,i)=>({type:"taskItem",raw:"",mainContent:o.mainContent,indentLevel:o.indentLevel,checked:o.checked,text:o.mainContent,tokens:n.inlineTokens(o.mainContent),nestedTokens:i}),customNestedParser:r},n);if(s)return{type:"taskList",raw:s.raw,items:s.items}}},markdownOptions:{indentsContent:!0},addCommands(){return{toggleTaskList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});S.create({name:"listKit",addExtensions(){const t=[];return this.options.bulletList!==!1&&t.push(ln.configure(this.options.bulletList)),this.options.listItem!==!1&&t.push(cn.configure(this.options.listItem)),this.options.listKeymap!==!1&&t.push(mn.configure(this.options.listKeymap)),this.options.orderedList!==!1&&t.push(bn.configure(this.options.orderedList)),this.options.taskItem!==!1&&t.push(Jo.configure(this.options.taskItem)),this.options.taskList!==!1&&t.push(Xo.configure(this.options.taskList)),t}});var aa=S.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:t=>t.length,wordCounter:t=>t.split(" ").filter(e=>e!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=t=>{const e=t?.node||this.editor.state.doc;if((t?.mode||this.options.mode)==="textSize"){const r=e.textBetween(0,e.content.size,void 0," ");return this.options.textCounter(r)}return e.nodeSize},this.storage.words=t=>{const e=t?.node||this.editor.state.doc,n=e.textBetween(0,e.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let t=!1;return[new I({key:new _("characterCount"),appendTransaction:(e,n,r)=>{if(t)return;const s=this.options.limit;if(s==null||s===0){t=!0;return}const o=this.storage.characters({node:r.doc});if(o>s){const i=o-s,a=0,l=i;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const c=r.tr.deleteRange(a,l);return t=!0,c}t=!0},filterTransaction:(e,n)=>{const r=this.options.limit;if(!e.docChanged||r===0||r===null||r===void 0)return!0;const s=this.storage.characters({node:n.doc}),o=this.storage.characters({node:e.doc});if(o<=r||s>r&&o>r&&o<=s)return!0;if(s>r&&o>r&&o>s||!e.getMeta("paste"))return!1;const a=e.selection.$head.pos,l=o-r,c=a-l,u=a;return e.deleteRange(c,u),!(this.storage.characters({node:e.doc})>r)}})]}}),Yo=S.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[lr(this.options)]}});S.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new I({key:new _("focus"),props:{decorations:({doc:t,selection:e})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:s}=e,o=[];if(!n||!r)return ut.create(t,[]);let i=0;this.options.mode==="deepest"&&t.descendants((l,c)=>{if(l.isText)return;if(!(s>=c&&s<=c+l.nodeSize-1))return!1;i+=1});let a=0;return t.descendants((l,c)=>{if(l.isText||!(s>=c&&s<=c+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&i-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";o.push(Ot.node(c,c+l.nodeSize,{class:this.options.className}))}),ut.create(t,o)}}})]}});var yn=S.create({name:"gapCursor",addProseMirrorPlugins(){return[cr()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=T(v(t,"allowGapCursor",n)))!=null?e:null}}});S.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something â¦",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new I({key:new _("placeholder"),props:{decorations:({doc:t,selection:e})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,s=[];if(!n)return null;const o=this.editor.isEmpty;return t.descendants((i,a)=>{const l=r>=a&&r<=a+i.nodeSize,c=!i.isLeaf&&yt(i);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];o&&u.push(this.options.emptyEditorClass);const d=Ot.node(a,a+i.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:i,pos:a,hasAnchor:l}):this.options.placeholder});s.push(d)}return this.options.includeChildren}),ut.create(t,s)}}})]}});S.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:t,options:e}=this;return[new I({key:new _("selection"),props:{decorations(n){return n.selection.empty||t.isFocused||!t.isEditable||Fe(n.selection)||t.view.dragging?null:ut.create(n.doc,[Ot.inline(n.selection.from,n.selection.to,{class:e.className})])}}})]}});function be({types:t,node:e}){return e&&Array.isArray(t)&&t.includes(e.type)||e?.type===t}var Zo=S.create({name:"trailingNode",addOptions(){return{node:void 0,notAfter:[]}},addProseMirrorPlugins(){var t;const e=new _(this.name),n=((t=this.editor.schema.topNodeType.contentMatch.defaultType)==null?void 0:t.name)||this.options.node||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,s])=>s).filter(s=>(this.options.notAfter||[]).concat(n).includes(s.name));return[new I({key:e,appendTransaction:(s,o,i)=>{const{doc:a,tr:l,schema:c}=i,u=e.getState(i),d=a.content.size,p=c.nodes[n];if(u)return l.insert(d,p.create())},state:{init:(s,o)=>{const i=o.tr.doc.lastChild;return!be({node:i,types:r})},apply:(s,o)=>{if(!s.docChanged)return o;const i=s.doc.lastChild;return!be({node:i,types:r})}}})]}}),Qo=S.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>pr(t,e),redo:()=>({state:t,dispatch:e})=>dr(t,e)}},addProseMirrorPlugins(){return[ur(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Ñ":()=>this.editor.commands.undo(),"Shift-Mod-Ñ":()=>this.editor.commands.redo()}}}),ti=20,vn=(t,e=0)=>{const n=[];return!t.children.length||e>ti||Array.from(t.children).forEach(r=>{r.tagName==="SPAN"?n.push(r):r.children.length&&n.push(...vn(r,e+1))}),n},ei=t=>{if(!t.children.length)return;const e=vn(t);e&&e.forEach(n=>{var r,s;const o=n.getAttribute("style"),i=(s=(r=n.parentElement)==null?void 0:r.closest("span"))==null?void 0:s.getAttribute("style");n.setAttribute("style",`${i};${o}`)})},ni=F.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{},mergeNestedSpanStyles:!0}},parseHTML(){return[{tag:"span",consuming:!1,getAttrs:t=>t.hasAttribute("style")?(this.options.mergeNestedSpanStyles&&ei(t),{}):!1}]},renderHTML({HTMLAttributes:t}){return["span",E(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleTextStyle:t=>({commands:e})=>e.toggleMark(this.name,t),removeEmptyTextStyle:()=>({tr:t})=>{const{selection:e}=t;return t.doc.nodesBetween(e.from,e.to,(n,r)=>{if(n.isTextblock)return!0;n.marks.filter(s=>s.type===this.type).some(s=>Object.values(s.attrs).some(o=>!!o))||t.removeMark(r,r+n.nodeSize,this.type)}),!0}}}}),ri=S.create({name:"backgroundColor",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const o=r[s].split(":");if(o.length>=2){const i=o[0].trim().toLowerCase(),a=o.slice(1).join(":").trim();if(i==="background-color")return a.replace(/['"]+/g,"")}}}return(e=t.style.backgroundColor)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.backgroundColor?{style:`background-color: ${t.backgroundColor}`}:{}}}}]},addCommands(){return{setBackgroundColor:t=>({chain:e})=>e().setMark("textStyle",{backgroundColor:t}).run(),unsetBackgroundColor:()=>({chain:t})=>t().setMark("textStyle",{backgroundColor:null}).removeEmptyTextStyle().run()}}}),si=S.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:t=>{var e;const n=t.getAttribute("style");if(n){const r=n.split(";").map(s=>s.trim()).filter(Boolean);for(let s=r.length-1;s>=0;s-=1){const o=r[s].split(":");if(o.length>=2){const i=o[0].trim().toLowerCase(),a=o.slice(1).join(":").trim();if(i==="color")return a.replace(/['"]+/g,"")}}}return(e=t.style.color)==null?void 0:e.replace(/['"]+/g,"")},renderHTML:t=>t.color?{style:`color: ${t.color}`}:{}}}}]},addCommands(){return{setColor:t=>({chain:e})=>e().setMark("textStyle",{color:t}).run(),unsetColor:()=>({chain:t})=>t().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),oi=S.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:t=>t.style.fontFamily,renderHTML:t=>t.fontFamily?{style:`font-family: ${t.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:t=>({chain:e})=>e().setMark("textStyle",{fontFamily:t}).run(),unsetFontFamily:()=>({chain:t})=>t().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),ii=S.create({name:"fontSize",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:t=>t.style.fontSize,renderHTML:t=>t.fontSize?{style:`font-size: ${t.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:t=>({chain:e})=>e().setMark("textStyle",{fontSize:t}).run(),unsetFontSize:()=>({chain:t})=>t().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),ai=S.create({name:"lineHeight",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{lineHeight:{default:null,parseHTML:t=>t.style.lineHeight,renderHTML:t=>t.lineHeight?{style:`line-height: ${t.lineHeight}`}:{}}}}]},addCommands(){return{setLineHeight:t=>({chain:e})=>e().setMark("textStyle",{lineHeight:t}).run(),unsetLineHeight:()=>({chain:t})=>t().setMark("textStyle",{lineHeight:null}).removeEmptyTextStyle().run()}}});S.create({name:"textStyleKit",addExtensions(){const t=[];return this.options.backgroundColor!==!1&&t.push(ri.configure(this.options.backgroundColor)),this.options.color!==!1&&t.push(si.configure(this.options.color)),this.options.fontFamily!==!1&&t.push(oi.configure(this.options.fontFamily)),this.options.fontSize!==!1&&t.push(ii.configure(this.options.fontSize)),this.options.lineHeight!==!1&&t.push(ai.configure(this.options.lineHeight)),this.options.textStyle!==!1&&t.push(ni.configure(this.options.textStyle)),t}});var la=yn,li=L.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,E(this.options.HTMLAttributes,e),0]},parseMarkdown:(t,e)=>e.createNode("heading",{level:t.depth||1},e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>{var n;const r=(n=t.attrs)!=null&&n.level?parseInt(t.attrs.level,10):1,s="#".repeat(r);return t.content?`${s} ${e.renderChildren(t.content)}`:""},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>$t({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}}),ci=L.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{},nextNodeType:"paragraph"}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",E(this.options.HTMLAttributes,t)]},markdownTokenName:"hr",parseMarkdown:(t,e)=>e.createNode("horizontalRule"),renderMarkdown:()=>"---",addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!ho(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$to:r}=n,s=t();return Fe(n)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({state:o,tr:i,dispatch:a})=>{if(a){const{$to:l}=i.selection,c=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?i.setSelection(P.create(i.doc,l.pos+1)):l.nodeAfter.isBlock?i.setSelection(tt.create(i.doc,l.pos)):i.setSelection(P.create(i.doc,l.pos));else{const u=o.schema.nodes[this.options.nextNodeType]||l.parent.type.contentMatch.defaultType,d=u?.create();d&&(i.insert(c,d),i.setSelection(P.create(i.doc,c+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[rn({find:/^(?:---|â-|___\s|\*\*\*\s)$/,type:this.type})]}}),ui=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,di=L.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",E(this.options.HTMLAttributes,t)]},parseMarkdown:(t,e)=>e.createNode("image",{src:t.href,title:t.title,alt:t.text}),renderMarkdown:t=>{var e,n,r,s,o,i;const a=(n=(e=t.attrs)==null?void 0:e.src)!=null?n:"",l=(s=(r=t.attrs)==null?void 0:r.alt)!=null?s:"",c=(i=(o=t.attrs)==null?void 0:o.title)!=null?i:"";return c?`![${l}](${a} "${c}")`:`![${l}](${a})`},addCommands(){return{setImage:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[rn({find:ui,type:this.type,getAttributes:t=>{const[,,e,n,r]=t;return{src:n,alt:e,title:r}}})]}}),ca=di,Zt="[\0- Â áá â-\u2029âã]",pi=new RegExp(Zt),hi=new RegExp(`${Zt}$`),fi=new RegExp(Zt,"g");function mi(t){return t.length===1?t[0].isLink:t.length===3&&t[1].isLink?["()","[]"].includes(t[0].value+t[2].value):!1}function gi(t){return new I({key:new _("autolink"),appendTransaction:(e,n,r)=>{const s=e.some(c=>c.docChanged)&&!n.doc.eq(r.doc),o=e.some(c=>c.getMeta("preventAutolink"));if(!s||o)return;const{tr:i}=r,a=_e(n.doc,[...e]);if(ze(a).forEach(({newRange:c})=>{const u=vs(r.doc,c,h=>h.isTextblock);let d,p;if(u.length>1)d=u[0],p=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ");else if(u.length){const h=r.doc.textBetween(c.from,c.to," "," ");if(!hi.test(h))return;d=u[0],p=r.doc.textBetween(d.pos,c.to,void 0," ")}if(d&&p){const h=p.split(pi).filter(Boolean);if(h.length<=0)return!1;const f=h[h.length-1],m=d.pos+p.lastIndexOf(f);if(!f)return!1;const g=hr(f).map(b=>b.toObject(t.defaultProtocol));if(!mi(g))return!1;g.filter(b=>b.isLink).map(b=>({...b,from:m+b.start+1,to:m+b.end+1})).filter(b=>r.schema.marks.code?!r.doc.rangeHasMark(b.from,b.to,r.schema.marks.code):!0).filter(b=>t.validate(b.value)).filter(b=>t.shouldAutoLink(b.value)).forEach(b=>{Ut(b.from,b.to,r.doc).some(y=>y.mark.type===t.type)||i.addMark(b.from,b.to,t.type.create({href:b.href}))})}}),!!i.steps.length)return i}})}function bi(t){return new I({key:new _("handleClickLink"),props:{handleClick:(e,n,r)=>{var s,o;if(r.button!==0||!e.editable)return!1;let i=null;if(r.target instanceof HTMLAnchorElement)i=r.target;else{let u=r.target;const d=[];for(;u.nodeName!=="DIV";)d.push(u),u=u.parentNode;i=d.find(p=>p.nodeName==="A")}if(!i)return!1;const a=je(e.state,t.type.name),l=(s=i?.href)!=null?s:a.href,c=(o=i?.target)!=null?o:a.target;return t.enableClickSelection&&t.editor.commands.extendMarkRange(t.type.name),i&&l?(window.open(l,c),!0):!1}}})}function yi(t){return new I({key:new _("handlePasteLink"),props:{handlePaste:(e,n,r)=>{const{shouldAutoLink:s}=t,{state:o}=e,{selection:i}=o,{empty:a}=i;if(a)return!1;let l="";r.content.forEach(u=>{l+=u.textContent});const c=Ce(l,{defaultProtocol:t.defaultProtocol}).find(u=>u.isLink&&u.value===l);return!l||!c||s!==void 0&&!s(c.href)?!1:t.editor.commands.setMark(t.type,{href:c.href})}}})}function W(t,e){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return e&&e.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!t||t.replace(fi,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var kn=F.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(t=>{if(typeof t=="string"){te(t);return}te(t.scheme,t.optionalSlashes)})},onDestroy(){fr()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(t,e)=>!!W(t,e.protocols),validate:t=>!!t,shouldAutoLink:t=>!!t}},addAttributes(){return{href:{default:null,parseHTML(t){return t.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:t=>{const e=t.getAttribute("href");return!e||!this.options.isAllowedUri(e,{defaultValidate:n=>!!W(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:t}){return this.options.isAllowedUri(t.href,{defaultValidate:e=>!!W(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",E(this.options.HTMLAttributes,t),0]:["a",E(this.options.HTMLAttributes,{...t,href:""}),0]},markdownTokenName:"link",parseMarkdown:(t,e)=>e.applyMark("link",e.parseInline(t.tokens||[]),{href:t.href,title:t.title||null}),renderMarkdown:(t,e)=>{var n;const r=((n=t.attrs)==null?void 0:n.href)||"";return`[${e.renderChildren(t)}](${r})`},addCommands(){return{setLink:t=>({chain:e})=>{const{href:n}=t;return this.options.isAllowedUri(n,{defaultValidate:r=>!!W(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?e().setMark(this.name,t).setMeta("preventAutolink",!0).run():!1},toggleLink:t=>({chain:e})=>{const{href:n}=t||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!W(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[G({find:t=>{const e=[];if(t){const{protocols:n,defaultProtocol:r}=this.options,s=Ce(t).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:i=>!!W(i,n),protocols:n,defaultProtocol:r}));s.length&&s.forEach(o=>{this.options.shouldAutoLink(o.value)&&e.push({text:o.value,data:{href:o.href},index:o.start})})}return e},type:this.type,getAttributes:t=>{var e;return{href:(e=t.data)==null?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[],{protocols:e,defaultProtocol:n}=this.options;return this.options.autolink&&t.push(gi({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!W(s,e),protocols:e,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&t.push(bi({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&t.push(yi({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink})),t}}),ua=kn,wn=L.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{var e,n;const r=t.getAttribute("colwidth"),s=r?r.split(",").map(o=>parseInt(o,10)):null;if(!s){const o=(e=t.closest("table"))==null?void 0:e.querySelectorAll("colgroup > col"),i=Array.from(((n=t.parentElement)==null?void 0:n.children)||[]).indexOf(t);if(i&&i>-1&&o&&o[i]){const a=o[i].getAttribute("width");return a?[parseInt(a,10)]:null}}return s}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",E(this.options.HTMLAttributes,t),0]}}),Mn=L.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?e.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",E(this.options.HTMLAttributes,t),0]}}),xn=L.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",E(this.options.HTMLAttributes,t),0]}});function Rt(t,e){return e?["width",`${Math.max(e,t)}px`]:["min-width",`${t}px`]}function ye(t,e,n,r,s,o){var i;let a=0,l=!0,c=e.firstChild;const u=t.firstChild;if(u!==null)for(let d=0,p=0;d<u.childCount;d+=1){const{colspan:h,colwidth:f}=u.child(d).attrs;for(let m=0;m<h;m+=1,p+=1){const g=s===p?o:f&&f[m],b=g?`${g}px`:"";if(a+=g||r,g||(l=!1),c){if(c.style.width!==b){const[y,k]=Rt(r,g);c.style.setProperty(y,k)}c=c.nextSibling}else{const y=document.createElement("col"),[k,M]=Rt(r,g);y.style.setProperty(k,M),e.appendChild(y)}}}for(;c;){const d=c.nextSibling;(i=c.parentNode)==null||i.removeChild(c),c=d}l?(n.style.width=`${a}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${a}px`)}var vi=class{constructor(t,e){this.node=t,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ye(t,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,ye(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){const e=t.target,n=this.dom.contains(e),r=this.contentDOM.contains(e);return!!(n&&!r&&(t.type==="attributes"||t.type==="childList"||t.type==="characterData"))}};function ki(t,e,n,r){let s=0,o=!0;const i=[],a=t.firstChild;if(!a)return{};for(let d=0,p=0;d<a.childCount;d+=1){const{colspan:h,colwidth:f}=a.child(d).attrs;for(let m=0;m<h;m+=1,p+=1){const g=n===p?r:f&&f[m];s+=g||e,g||(o=!1);const[b,y]=Rt(e,g);i.push(["col",{style:`${b}: ${y}`}])}}const l=o?`${s}px`:"",c=o?"":`${s}px`;return{colgroup:["colgroup",{},...i],tableWidth:l,tableMinWidth:c}}function ve(t,e){return t.createAndFill()}function wi(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const e={};return Object.keys(t.nodes).forEach(n=>{const r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),t.cached.tableNodeTypes=e,e}function Mi(t,e,n,r,s){const o=wi(t),i=[],a=[];for(let c=0;c<n;c+=1){const u=ve(o.cell);if(u&&a.push(u),r){const d=ve(o.header_cell);d&&i.push(d)}}const l=[];for(let c=0;c<e;c+=1)l.push(o.row.createChecked(null,r&&c===0?i:a));return o.table.createChecked(null,l)}function xi(t){return t instanceof Te}var at=({editor:t})=>{const{selection:e}=t.state;if(!xi(e))return!1;let n=0;const r=Ne(e.ranges[0].$from,o=>o.type.name==="table");return r?.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(n+=1)}),n===e.ranges.length?(t.commands.deleteTable(),!0):!1},Ci="";function Ti(t){return(t||"").replace(/\s+/g," ").trim()}function Si(t,e,n={}){var r;const s=(r=n.cellLineSeparator)!=null?r:Ci;if(!t||!t.content||t.content.length===0)return"";const o=[];t.content.forEach(f=>{const m=[];f.content&&f.content.forEach(g=>{let b="";g.content&&Array.isArray(g.content)&&g.content.length>1?b=g.content.map(w=>e.renderChildren(w)).join(s):b=g.content?e.renderChildren(g.content):"";const y=Ti(b),k=g.type==="tableHeader";m.push({text:y,isHeader:k})}),o.push(m)});const i=o.reduce((f,m)=>Math.max(f,m.length),0);if(i===0)return"";const a=new Array(i).fill(0);o.forEach(f=>{var m;for(let g=0;g<i;g+=1){const y=(((m=f[g])==null?void 0:m.text)||"").length;y>a[g]&&(a[g]=y),a[g]<3&&(a[g]=3)}});const l=(f,m)=>f+" ".repeat(Math.max(0,m-f.length)),c=o[0],u=c.some(f=>f.isHeader);let d=`
`;const p=new Array(i).fill(0).map((f,m)=>u&&c[m]&&c[m].text||"");return d+=`| ${p.map((f,m)=>l(f,a[m])).join(" | ")} |
`,d+=`| ${a.map(f=>"-".repeat(Math.max(3,f))).join(" | ")} |
`,(u?o.slice(1):o).forEach(f=>{d+=`| ${new Array(i).fill(0).map((m,g)=>l(f[g]&&f[g].text||"",a[g])).join(" | ")} |
`}),d}var Ei=Si,Ai=L.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,renderWrapper:!1,handleWidth:5,cellMinWidth:25,View:vi,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:t,HTMLAttributes:e}){const{colgroup:n,tableWidth:r,tableMinWidth:s}=ki(t,this.options.cellMinWidth),o=["table",E(this.options.HTMLAttributes,e,{style:r?`width: ${r}`:`min-width: ${s}`}),n,["tbody",0]];return this.options.renderWrapper?["div",{class:"tableWrapper"},o]:o},parseMarkdown:(t,e)=>{const n=[];if(t.header){const r=[];t.header.forEach(s=>{r.push(e.createNode("tableHeader",{},[{type:"paragraph",content:e.parseInline(s.tokens)}]))}),n.push(e.createNode("tableRow",{},r))}return t.rows&&t.rows.forEach(r=>{const s=[];r.forEach(o=>{s.push(e.createNode("tableCell",{},[{type:"paragraph",content:e.parseInline(o.tokens)}]))}),n.push(e.createNode("tableRow",{},s))}),e.createNode("table",void 0,n)},renderMarkdown:(t,e)=>Ei(t,e),addCommands(){return{insertTable:({rows:t=3,cols:e=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:s,editor:o})=>{const i=Mi(o.schema,t,e,n);if(s){const a=r.selection.from+1;r.replaceSelectionWith(i).scrollIntoView().setSelection(P.near(r.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:t,dispatch:e})=>Sr(t,e),addColumnAfter:()=>({state:t,dispatch:e})=>Tr(t,e),deleteColumn:()=>({state:t,dispatch:e})=>Cr(t,e),addRowBefore:()=>({state:t,dispatch:e})=>xr(t,e),addRowAfter:()=>({state:t,dispatch:e})=>Mr(t,e),deleteRow:()=>({state:t,dispatch:e})=>wr(t,e),deleteTable:()=>({state:t,dispatch:e})=>kr(t,e),mergeCells:()=>({state:t,dispatch:e})=>ne(t,e),splitCell:()=>({state:t,dispatch:e})=>re(t,e),toggleHeaderColumn:()=>({state:t,dispatch:e})=>se("column")(t,e),toggleHeaderRow:()=>({state:t,dispatch:e})=>se("row")(t,e),toggleHeaderCell:()=>({state:t,dispatch:e})=>vr(t,e),mergeOrSplit:()=>({state:t,dispatch:e})=>ne(t,e)?!0:re(t,e),setCellAttribute:(t,e)=>({state:n,dispatch:r})=>yr(t,e)(n,r),goToNextCell:()=>({state:t,dispatch:e})=>ee(1)(t,e),goToPreviousCell:()=>({state:t,dispatch:e})=>ee(-1)(t,e),fixTables:()=>({state:t,dispatch:e})=>(e&&br(t),!0),setCellSelection:t=>({tr:e,dispatch:n})=>{if(n){const r=Te.create(e.doc,t.anchorCell,t.headCell);e.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:at,"Mod-Backspace":at,Delete:at,"Mod-Delete":at}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[mr({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],gr({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const e={name:t.name,options:t.options,storage:t.storage};return{tableRole:T(v(t,"tableRole",e))}}});S.create({name:"tableKit",addExtensions(){const t=[];return this.options.table!==!1&&t.push(Ai.configure(this.options.table)),this.options.tableCell!==!1&&t.push(wn.configure(this.options.tableCell)),this.options.tableHeader!==!1&&t.push(Mn.configure(this.options.tableHeader)),this.options.tableRow!==!1&&t.push(xn.configure(this.options.tableRow)),t}});var da=wn,pa=Mn,ha=xn,Li=S.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:null}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:t=>{const e=t.style.textAlign;return this.options.alignments.includes(e)?e:this.options.defaultAlignment},renderHTML:t=>t.textAlign?{style:`text-align: ${t.textAlign}`}:{}}}}]},addCommands(){return{setTextAlign:t=>({commands:e})=>this.options.alignments.includes(t)?this.options.types.map(n=>e.updateAttributes(n,{textAlign:t})).every(n=>n):!1,unsetTextAlign:()=>({commands:t})=>this.options.types.map(e=>t.resetAttributes(e,"textAlign")).every(e=>e),toggleTextAlign:t=>({editor:e,commands:n})=>this.options.alignments.includes(t)?e.isActive({textAlign:t})?n.unsetTextAlign():n.setTextAlign(t):!1}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),fa=Li,$i=/^((?:https?:)?\/\/)?((?:www|m|music)\.)?((?:youtube\.com|youtu\.be|youtube-nocookie\.com))(\/(?:[\w-]+\?v=|embed\/|v\/)?)([\w-]+)(\S+)?$/,Ii=/^((?:https?:)?\/\/)?((?:www|m|music)\.)?((?:youtube\.com|youtu\.be|youtube-nocookie\.com))(\/(?:[\w-]+\?v=|embed\/|v\/)?)([\w-]+)(\S+)?$/g,Cn=t=>t.match($i),ke=(t,e)=>e?"https://www.youtube-nocookie.com/embed/videoseries?list=":t?"https://www.youtube-nocookie.com/embed/":"https://www.youtube.com/embed/",Pi=t=>{const{url:e,allowFullscreen:n,autoplay:r,ccLanguage:s,ccLoadPolicy:o,controls:i,disableKBcontrols:a,enableIFrameApi:l,endTime:c,interfaceLanguage:u,ivLoadPolicy:d,loop:p,modestBranding:h,nocookie:f,origin:m,playlist:g,progressBarColor:b,startAt:y,rel:k}=t;if(!Cn(e))return null;if(e.includes("/embed/"))return e;if(e.includes("youtu.be")){const $=e.split("/").pop();return $?`${ke(f)}${$}`:null}const w=/(?:(v|list)=|shorts\/)([-\w]+)/gm.exec(e);if(!w||!w[2])return null;let C=`${ke(f,w[1]==="list")}${w[2]}`;const x=[];return n===!1&&x.push("fs=0"),r&&x.push("autoplay=1"),s&&x.push(`cc_lang_pref=${s}`),o&&x.push("cc_load_policy=1"),i||x.push("controls=0"),a&&x.push("disablekb=1"),l&&x.push("enablejsapi=1"),c&&x.push(`end=${c}`),u&&x.push(`hl=${u}`),d&&x.push(`iv_load_policy=${d}`),p&&x.push("loop=1"),h&&x.push("modestbranding=1"),m&&x.push(`origin=${m}`),g&&x.push(`playlist=${g}`),y&&x.push(`start=${y}`),b&&x.push(`color=${b}`),k!==void 0&&x.push(`rel=${k}`),x.length&&(C+=`${w[1]==="v"?"?":"&"}${x.join("&")}`),C},ma=L.create({name:"youtube",addOptions(){return{addPasteHandler:!0,allowFullscreen:!0,autoplay:!1,ccLanguage:void 0,ccLoadPolicy:void 0,controls:!0,disableKBcontrols:!1,enableIFrameApi:!1,endTime:0,height:480,interfaceLanguage:void 0,ivLoadPolicy:0,loop:!1,modestBranding:!1,HTMLAttributes:{},inline:!1,nocookie:!1,origin:"",playlist:"",progressBarColor:void 0,width:640,rel:1}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},start:{default:0},width:{default:this.options.width},height:{default:this.options.height}}},parseHTML(){return[{tag:"div[data-youtube-video] iframe"}]},addCommands(){return{setYoutubeVideo:t=>({commands:e})=>Cn(t.src)?e.insertContent({type:this.name,attrs:t}):!1}},addPasteRules(){return this.options.addPasteHandler?[ko({find:Ii,type:this.type,getAttributes:t=>({src:t.input})})]:[]},renderHTML({HTMLAttributes:t}){const e=Pi({url:t.src,allowFullscreen:this.options.allowFullscreen,autoplay:this.options.autoplay,ccLanguage:this.options.ccLanguage,ccLoadPolicy:this.options.ccLoadPolicy,controls:this.options.controls,disableKBcontrols:this.options.disableKBcontrols,enableIFrameApi:this.options.enableIFrameApi,endTime:this.options.endTime,interfaceLanguage:this.options.interfaceLanguage,ivLoadPolicy:this.options.ivLoadPolicy,loop:this.options.loop,modestBranding:this.options.modestBranding,nocookie:this.options.nocookie,origin:this.options.origin,playlist:this.options.playlist,progressBarColor:this.options.progressBarColor,startAt:t.start||0,rel:this.options.rel});return t.src=e,["div",{"data-youtube-video":""},["iframe",E(this.options.HTMLAttributes,{width:this.options.width,height:this.options.height,allowfullscreen:this.options.allowFullscreen,autoplay:this.options.autoplay,ccLanguage:this.options.ccLanguage,ccLoadPolicy:this.options.ccLoadPolicy,disableKBcontrols:this.options.disableKBcontrols,enableIFrameApi:this.options.enableIFrameApi,endTime:this.options.endTime,interfaceLanguage:this.options.interfaceLanguage,ivLoadPolicy:this.options.ivLoadPolicy,loop:this.options.loop,modestBranding:this.options.modestBranding,origin:this.options.origin,playlist:this.options.playlist,progressBarColor:this.options.progressBarColor,rel:this.options.rel},t)]]},...sn({nodeName:"youtube",allowedAttributes:["src","width","height","start"]})}),_i=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Ni=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Ri=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Bi=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Oi=F.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return ht("strong",{...E(this.options.HTMLAttributes,t),children:ht("slot",{})})},markdownTokenName:"strong",parseMarkdown:(t,e)=>e.applyMark("bold",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`**${e.renderChildren(t)}**`,addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[X({find:_i,type:this.type}),X({find:Ri,type:this.type})]},addPasteRules(){return[G({find:Ni,type:this.type}),G({find:Bi,type:this.type})]}}),Hi=/(^|[^`])`([^`]+)`(?!`)$/,Di=/(^|[^`])`([^`]+)`(?!`)/g,ji=F.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",E(this.options.HTMLAttributes,t),0]},markdownTokenName:"codespan",parseMarkdown:(t,e)=>e.applyMark("code",[{type:"text",text:t.text||""}]),renderMarkdown:(t,e)=>t.content?`\`${e.renderChildren(t.content)}\``:"",addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[X({find:Hi,type:this.type})]},addPasteRules(){return[G({find:Di,type:this.type})]}}),Et=4,zi=/^```([a-z]+)?[\s\n]$/,Fi=/^~~~([a-z]+)?[\s\n]$/,Vi=L.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,enableTabIndentation:!1,tabSize:Et,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options;if(!n)return null;const o=[...((e=t.firstElementChild)==null?void 0:e.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",E(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},markdownTokenName:"code",parseMarkdown:(t,e)=>{var n;return((n=t.raw)==null?void 0:n.startsWith("```"))===!1&&t.codeBlockStyle!=="indented"?[]:e.createNode("codeBlock",{language:t.lang||null},t.text?[e.createTextNode(t.text)]:[])},renderMarkdown:(t,e)=>{var n;let r="";const s=((n=t.attrs)==null?void 0:n.language)||"";return t.content?r=[`\`\`\`${s}`,e.renderChildren(t.content),"```"].join(`
`):r=`\`\`\`${s}

\`\`\``,r},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Tab:({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:Et,{state:r}=t,{selection:s}=r,{$from:o,empty:i}=s;if(o.parent.type!==this.type)return!1;const a=" ".repeat(n);return i?t.commands.insertContent(a):t.commands.command(({tr:l})=>{const{from:c,to:u}=s,h=r.doc.textBetween(c,u,`
`,`
`).split(`
`).map(f=>a+f).join(`
`);return l.replaceWith(c,u,r.schema.text(h)),!0})},"Shift-Tab":({editor:t})=>{var e;if(!this.options.enableTabIndentation)return!1;const n=(e=this.options.tabSize)!=null?e:Et,{state:r}=t,{selection:s}=r,{$from:o,empty:i}=s;return o.parent.type!==this.type?!1:i?t.commands.command(({tr:a})=>{var l;const{pos:c}=o,u=o.start(),d=o.end(),h=r.doc.textBetween(u,d,`
`,`
`).split(`
`);let f=0,m=0;const g=c-u;for(let C=0;C<h.length;C+=1){if(m+h[C].length>=g){f=C;break}m+=h[C].length+1}const y=((l=h[f].match(/^ */))==null?void 0:l[0])||"",k=Math.min(y.length,n);if(k===0)return!0;let M=u;for(let C=0;C<f;C+=1)M+=h[C].length+1;return a.delete(M,M+k),c-M<=k&&a.setSelection(P.create(a.doc,M)),!0}):t.commands.command(({tr:a})=>{const{from:l,to:c}=s,p=r.doc.textBetween(l,c,`
`,`
`).split(`
`).map(h=>{var f;const m=((f=h.match(/^ */))==null?void 0:f[0])||"",g=Math.min(m.length,n);return h.slice(g)}).join(`
`);return a.replaceWith(l,c,r.schema.text(p)),!0})},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,i=r.parent.textContent.endsWith(`

`);return!o||!i?!1:t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:s,empty:o}=n;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?t.commands.command(({tr:c})=>(c.setSelection(K.near(r.resolve(a))),!0)):t.commands.exitCode()}}},addInputRules(){return[$t({find:zi,type:this.type,getAttributes:t=>({language:t[1]})}),$t({find:Fi,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new I({key:new _("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,o=s?.mode;if(!n||!o)return!1;const{tr:i,schema:a}=t.state,l=a.text(n.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:o},l)),i.selection.$from.parent.type!==this.type&&i.setSelection(P.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),t.dispatch(i),!0}}})]}}),Wi=L.create({name:"doc",topNode:!0,content:"block+",renderMarkdown:(t,e)=>t.content?e.renderChildren(t.content,`

`):""}),Ui=L.create({name:"hardBreak",markdownTokenName:"br",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",E(this.options.HTMLAttributes,t)]},renderText(){return`
`},renderMarkdown:(t,e)=>e.indent(`
`),parseMarkdown:()=>({type:"hardBreak"}),addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:s,storedMarks:o}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=r.extensionManager,l=o||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&i){const d=l.filter(p=>a.includes(p.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Ki=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,qi=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Gi=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Ji=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Xi=F.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",E(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(t,e)=>e.applyMark("italic",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`*${e.renderChildren(t)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[X({find:Ki,type:this.type}),X({find:Gi,type:this.type})]},addPasteRules(){return[G({find:qi,type:this.type}),G({find:Ji,type:this.type})]}}),Yi=L.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",E(this.options.HTMLAttributes,t),0]},parseMarkdown:(t,e)=>{const n=t.tokens||[];return n.length===1&&n[0].type==="image"?e.parseChildren([n[0]]):e.createNode("paragraph",void 0,e.parseInline(n))},renderMarkdown:(t,e)=>!t||!Array.isArray(t.content)?"":e.renderChildren(t.content),addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Zi=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Qi=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,ta=F.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",E(this.options.HTMLAttributes,t),0]},markdownTokenName:"del",parseMarkdown:(t,e)=>e.applyMark("strike",e.parseInline(t.tokens||[])),renderMarkdown:(t,e)=>`~~${e.renderChildren(t)}~~`,addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[X({find:Zi,type:this.type})]},addPasteRules(){return[G({find:Qi,type:this.type})]}}),ea=L.create({name:"text",group:"inline",parseMarkdown:t=>({type:"text",text:t.text||""}),renderMarkdown:t=>t.text||""}),na=F.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["u",E(this.options.HTMLAttributes,t),0]},parseMarkdown(t,e){return e.applyMark(this.name||"underline",e.parseInline(t.tokens||[]))},renderMarkdown(t,e){return`++${e.renderChildren(t)}++`},markdownTokenizer:{name:"underline",level:"inline",start(t){return t.indexOf("++")},tokenize(t,e,n){const s=/^(\+\+)([\s\S]+?)(\+\+)/.exec(t);if(!s)return;const o=s[2].trim();return{type:"underline",raw:s[0],text:o,tokens:n.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:t})=>t.setMark(this.name),toggleUnderline:()=>({commands:t})=>t.toggleMark(this.name),unsetUnderline:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),ra=S.create({name:"starterKit",addExtensions(){var t,e,n,r;const s=[];return this.options.bold!==!1&&s.push(Oi.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(Ho.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(ln.configure(this.options.bulletList)),this.options.code!==!1&&s.push(ji.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(Vi.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(Wi.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(Yo.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(yn.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(Ui.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(li.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(Qo.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(ci.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(Xi.configure(this.options.italic)),this.options.listItem!==!1&&s.push(cn.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(mn.configure((t=this.options)==null?void 0:t.listKeymap)),this.options.link!==!1&&s.push(kn.configure((e=this.options)==null?void 0:e.link)),this.options.orderedList!==!1&&s.push(bn.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(Yi.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(ta.configure(this.options.strike)),this.options.text!==!1&&s.push(ea.configure(this.options.text)),this.options.underline!==!1&&s.push(na.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&s.push(Zo.configure((r=this.options)==null?void 0:r.trailingNode)),s}}),ga=ra;export{Ho as B,aa as C,ia as E,oi as F,li as H,cn as L,L as N,bn as O,Ai as T,ma as Y,ua as a,ca as b,fa as c,ln as d,ci as e,la as f,ha as g,pa as h,ga as i,da as j,si as k,ni as l,E as m,oa as u};
